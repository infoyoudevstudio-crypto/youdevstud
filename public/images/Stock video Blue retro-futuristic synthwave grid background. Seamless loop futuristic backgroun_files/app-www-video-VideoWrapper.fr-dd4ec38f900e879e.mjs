(self.modernJsonp=self.modernJsonp||[]).push([["57120"],{228801(e){var t=[],a=[];e.exports=function(e,r){var i=t.length?t.pop():[],n=a.length?a.pop():[],s=function e(t,a,r,i){if(t===a)return 0!==t||1/t==1/a;if(null==t||null==a||"object"!=typeof t||"object"!=typeof a)return!1;var n=Object.prototype.toString,s=n.call(t);if(s!=n.call(a))return!1;switch(s){case"[object String]":return t==String(a);case"[object Number]":return!(isNaN(t)||isNaN(a))&&t==Number(a);case"[object Date]":case"[object Boolean]":return+t==+a;case"[object RegExp]":return t.source==a.source&&t.global==a.global&&t.multiline==a.multiline&&t.ignoreCase==a.ignoreCase}for(var o=r.length;o--;)if(r[o]==t)return i[o]==a;r.push(t),i.push(a);var l=0;if("[object Array]"===s){if((l=t.length)!==a.length)return!1;for(;l--;)if(!e(t[l],a[l],r,i))return!1}else{if(t.constructor!==a.constructor)return!1;if(t.hasOwnProperty("valueOf")&&a.hasOwnProperty("valueOf"))return t.valueOf()==a.valueOf();var d=Object.keys(t);if(d.length!=Object.keys(a).length)return!1;for(var u=0;u<d.length;u++)if(!e(t[d[u]],a[d[u]],r,i))return!1}return r.pop(),i.pop(),!0}(e,r,i,n);return i.length=0,n.length=0,t.push(i),a.push(n),s}},615046(e){function t(e){return function(){return e}}var a=function(){};a.thatReturns=t,a.thatReturnsFalse=t(!1),a.thatReturnsTrue=t(!0),a.thatReturnsNull=t(null),a.thatReturnsThis=function(){return this},a.thatReturnsArgument=function(e){return e},e.exports=a},128827(e,t,a){e.exports=a(615046)},315075(e,t,a){a.d(t,{A:()=>n});var r,i=new Uint8Array(16);function n(){if(!r&&!(r="u">typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"u">typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}},542637(e,t,a){a.d(t,{A:()=>s});let r=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var i=[],n=0;n<256;++n)i.push((n+256).toString(16).substr(1));let s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]).toLowerCase();if(!("string"==typeof a&&r.test(a)))throw TypeError("Stringified UUID is invalid");return a}},679902(e,t,a){a.d(t,{A:()=>n});var r=a(315075),i=a(542637);let n=function(e,t,a){var n=(e=e||{}).random||(e.rng||r.A)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){a=a||0;for(var s=0;s<16;++s)t[a+s]=n[s];return t}return(0,i.A)(n)}},699667(e,t,a){a.r(t),a.d(t,{default:()=>i});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VideoWrapper_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="35625201030ecf10998f70bc5b4b5501";let i=r},957159(e,t,a){var r,i,n,s;a.r(t),a.d(t,{default:()=>l});let o=(r={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},s=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"officialUser",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null}],storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin",selections:[{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:[r,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},i,{alias:null,args:null,concreteType:"Domain",kind:"LinkedField",name:"linkDomain",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"UserWebsite",kind:"LinkedField",name:"linkUserWebsite",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"standardPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null});o.hash="b2a27d44d1f3dbd42301b82866212272";let l=o},371955(e,t,a){a.d(t,{AF:()=>k,HA:()=>v,IK:()=>P,K0:()=>g,LT:()=>E,Ve:()=>S,uo:()=>b});var r=a(335831),i=a(859471),n=a(526302),s=a(605563),o=a(892804),l=a(562615);let d={},u={},c={},h=!1,p=0,m={},f={},y=(0,i.createContext)({setMetric:()=>void 0,setRawData:()=>void 0,setRmaData:()=>void 0,updateCommitTimeMap:()=>void 0,setGroupTags:()=>void 0,commitTimeMap:{},wasHealthCheckFiredRef:{current:!1}});function g({children:e}){(0,i.useEffect)(()=>{(0,r.A)("RenderPerformanceContext","/app/common/react/components/ProfilerWithStats/RenderPerformanceContext.tsx")},[]);let t=(0,i.useRef)(!1),a=(0,i.useCallback)(({handlerId:e,componentId:t,uniqueId:a,metric:r})=>{d[e]||(d[e]={}),d[e][t]||(d[e][t]={}),d[e][t][a]=r},[]),s=(0,i.useCallback)(({handlerId:e,componentId:t,uniqueId:a,rawData:r})=>{c[e]||(c[e]={}),c[e][t]||(c[e][t]={}),c[e][t][a]||(c[e][t][a]=[]),c[e][t][a].push(r)},[]),o=(0,i.useCallback)(({id:e,path:t,fragmentName:a,executionTime:r,newData:i})=>{if(h)return;let s=`${a}.${e}`;u[t]||(u[t]={}),u[t][s]||(u[t][s]={totalRenderTime:0,previousData:{},renderCount:0,resultUpdatedCount:0,wastedTime:0});let o=u[t][s];(0,n.Ay)(i,o.previousData)?(o.wastedTime+=r,p+=r):o.resultUpdatedCount+=1,o.totalRenderTime+=r,o.renderCount+=1,o.previousData=i},[]),g=(0,i.useCallback)((e,t)=>{let a=`${Math.floor(e)}`;m[a]?m[a].push(t):m[a]=[t]},[]),S=(0,i.useCallback)((e,t)=>{f[e]=[...new Set(t)]},[]),b=(0,i.useMemo)(()=>({setMetric:a,setRawData:s,setRmaData:o,updateCommitTimeMap:g,setGroupTags:S,commitTimeMap:m,wasHealthCheckFiredRef:t}),[a,o,s,g,t,S]);return(0,l.jsx)(y,{value:b,children:e})}function S(){return(0,i.use)(y)}function b(e){let t,a,r,i,n={},o=(a=(t=Object.keys(m)).length,r=t.sort().slice(0,a),i={},r.forEach(e=>{let t=m[e];if(!t)return;let a=t.sort((e,t)=>e.startTime-t.startTime);for(let e=0;e<a.length;e+=1){let t=a[e],r=a[e+1];if(t&&r){let{startTime:e,id:a,uniqueId:n,actualDuration:s}=t,{startTime:o}=r,l=o<e+s?o-e:s;i[a]||(i[a]={}),i[a][n]||(i[a][n]=0),i[a][n]+=l}else if(t){let{actualDuration:e,id:a,uniqueId:r}=t;i[a]||(i[a]={}),i[a][r]||(i[a][r]=0),i[a][r]+=e}}}),i);return Object.keys(o).forEach(t=>{Object.keys(d[e]?.[t]??{}).forEach(a=>{let r=(0,s.SB)(t,a),i=o[t]?.[a],l=d[e]?.[t]?.[a];if(!i||!l)return;let u=l.mountTime??0,c=l.mountCount??0,h=l.updatesCount??0,p=Number(i.toFixed(2)),m=Number((u+p).toFixed(2)),y=h>0?Number((p/h).toFixed(2)):0,g=l.memoizationDeltaArray??[],S=Math.max(...g),b=g.reduce((e,t)=>e+t,0)/g.length,v=l.memoizationRatioArray??[],P=Math.max(...v),k=v.reduce((e,t)=>e+t,0)/v.length,E={...l,totalCount:c+h,totalTiming:m,updatesCount:h,updateTiming:p,averageUpdateTiming:y,maxMemoizationDelta:S,averageMemoizationDelta:b,maxMemoizationRatio:P,averageMemoizationRatio:k};n[t]||(n[t]={}),n[t][a]={groupTags:f[r]??[],metrics:E}})}),n}function v(e){return c[e]}function P(e){return["www/index.js","www/homefeed.js","www/pin/[id].js","www/collage-creation-tool.js","www/search/[scope].js"].includes(e)}function k(e){let t=u[e],a={};h=!0,t&&Object.keys(t).length&&P(e)&&(Object.entries(t).forEach(([e,t])=>{let[r]=e.split(".");r&&!a[r]&&(a[r]=!0,(0,o.U9)(`render_stats.rma.${r}.renderCount`,t.renderCount,{sampleRate:1}),(0,o.U9)(`render_stats.rma.${r}.resultUpdatedCount`,t.resultUpdatedCount,{sampleRate:1}),(0,o.N9)(`render_stats.rma.${r}.renderTime`,t.totalRenderTime,{sampleRate:1}),(0,o.N9)(`render_stats.rma.${r}.wastedTime`,t.totalRenderTime,{sampleRate:1}))}),(0,o.N9)("render_stats.rma.totalWastedTime",p,{sampleRate:1,tags:{path:e}}))}function E(){d={},u={},c={},m={},h=!1,p=0}},132114(e,t,a){a.d(t,{A:()=>u,U:()=>d});var r=a(335831),i=a(859471),n=a(836737),s=a(396901),o=a(922834),l=a(562615);let d="media-viewer-full";function u({children:e,onOutsideClick:t,onKeyboardExit:a}){(0,i.useEffect)(()=>{(0,r.A)("CloseupMediaViewerBackdrop","/app/common/react/components/auth-desktop-web-closeup/CloseupBody/MediaViewer/CloseupMediaViewerBackdrop.tsx")},[]);let u=(0,s.A)();return(0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[a]),(0,l.jsx)(i.Fragment,{children:(0,l.jsxs)(n.az,{alignItems:"center","aria-label":u.bt("Lecteur de mÃ©dias", "Media Viewer", "closeup.mediaViewer.label", undefined, true),"aria-modal":"true","data-test-id":d,display:"flex",height:"100vh",justifyContent:"center",left:!0,position:"fixed",role:"dialog",top:!0,width:"100vw",zIndex:o.y,children:[e,(0,l.jsx)("div",{onClick:e=>{e.target===e.currentTarget&&t()},role:"presentation",style:{backgroundColor:"rgba(0, 0, 0, 0.85)",backdropFilter:"blur(4px)",position:"absolute",bottom:0,left:0,right:0,top:0,marginBottom:"-1px"}})]})})}},578576(e,t,a){a.d(t,{$c:()=>m,BQ:()=>h,CD:()=>E,Ce:()=>c,GY:()=>u,IO:()=>C,Kd:()=>P,NC:()=>l,OU:()=>w,T3:()=>p,Vc:()=>b,Y:()=>R,Yc:()=>y,Yo:()=>S,ZL:()=>o,aP:()=>f,iI:()=>k,kj:()=>v,lr:()=>A,nQ:()=>T,qw:()=>D,sE:()=>g,ul:()=>d,zQ:()=>_});var r=a(836737),i=a(132114),n=a(507120),s=a(208762);let o={boxShadow:"0 1px 20px 0 rgba(0, 0, 0, 0.1)",borderRadius:32},l=e=>`${e.substring(0,33)}${e.length>33?"...":""}`,d=375,u=4,c=new Set(["related_modules_header","related_products_feed_header"]),h=({verticalNavWidth:e})=>({BREAKPOINT:1056+e,BACKBUTTON_WITH_LABEL_WIDE_BREAKPOINT:1340+e,SM_BREAKPOINT:680+e,EXP_SM_BREAKPOINT:814+e}),p=16,m=64,f=290,y=100,g=480,S=new r.rk(5);function b(e=0,t=0){let{peekCloseupEnabled:a,viewportSize:r}=(0,s._G)(),i=(0,n.A)();if(!a)return{maxWidth:void 0,maxHeight:void 0,fiftyPercentWidth:void 0,fiftyPercentHeight:void 0};let o={sm:96,md:96,lg:244}[r],l={sm:m,md:m,lg:m}[r],d=`100vw - ${2*o}px - ${e}px`,u=`100vh - 80px - ${l}px - ${t}px`,c={maxWidth:`calc(${d})`,maxHeight:`calc(${u})`,fiftyPercentWidth:"sm"===r?`calc(${d})`:`calc((${d})/2)`,fiftyPercentHeight:`calc((${u})/2)`};if(i)return c;let h=window?.innerWidth-2*o-e,p=window?.innerHeight-80-l-t;return{...c,numericValues:{maxWidth:h,maxHeight:window?.innerHeight-80-l-t,fiftyPercentWidth:"sm"===r?h:h/2,fiftyPercentHeight:p/2}}}function v({objectFit:e,variant:t}){let{peekCloseupEnabled:a,viewportSize:r}=(0,s._G)(),{maxHeight:n,maxWidth:o,fiftyPercentHeight:l,fiftyPercentWidth:d}=b();if("media-viewer"===t)return{};let u=`video:not([data-test-id=${i.U}] video)`;return{styleOverrides:a?`
      ${u} {
        max-height: ${"sm"===r?l:n};
        max-width: ${d};
      }
    `:"",objectFit:a?"contain":e,maxHeight:n,maxWidth:o,fiftyPercentHeight:l}}function P({peekCloseupEnabled:e,viewportSize:t,surface:a}){return!!e&&"lg"===t&&"ShoppingGridSmallCarousel"===a}let k={columnSpan:{sm:2,md:2,_lg1:3,lg:3,xl:5},type:"closeup_module",virtualize:!1},E={md:4,lg:4,lg1:4,xl:5},T={columnSpan:{sm:2,md:4,lg1:4,lg:5,xl:6},type:"closeup_module",virtualize:!1},_={columnSpan:{sm:2,md:2,_lg1:2,lg:2,xl:4},type:"shopping_module",virtualize:!1},w="1px solid var(--sema-color-background-secondary)",A="#FFFFFF",D={boxShadow:"unset",borderRadius:16},C={columnSpan:{sm:2,md:2,_lg1:2,lg:2,xl:2},type:"inclusive_filters_module",virtualize:!1},R={closeupWrapperStyle:{cursor:"zoom-out",display:"flex",width:"100%"},storyPinGradientStyle:{display:"block",position:"relative",cursor:"auto"}}},405661(e,t,a){a.d(t,{A:()=>r});let r=({carouselData:e,domain:t})=>{let a="",r=t||"";if(e){let{carouselSlots:t=[]}=e,i=e.index??0;t&&t[i]&&(a=t[i].link||"",r=t[i].domain||r)}return{carouselLink:a,currentDomain:r}}},363906(e,t,a){a.d(t,{A:()=>p});var r,i=a(859471);a(224989);var n=a(405661),s=a(296377),o=a(900565),l=a(757893),d=a(852758),u=a(507120),c=a(208762);let h=(void 0!==r||(r=a(957159)).hash&&"b2a27d44d1f3dbd42301b82866212272"!==r.hash&&console.error("The definition of 'useCalculateMaxWidthAndHeightForSideBySideVariant_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function p({pinKey:e,isVideo:t}){let{closeupWithinMasonryEnabled:a}=(0,c._G)(),r=(0,u.A)(),p=(0,o.A)(h,e),m=(0,s.A)({showProductDetailPage:!!p?.isEligibleForPdp}),{group:f}=(0,l.A)(),y=(0,i.useMemo)(()=>p?.carouselData?{carouselSlots:p.carouselData.carouselSlots?.map(e=>({domain:e.domain,link:e.link}))||[],index:p.carouselData.index}:void 0,[p?.carouselData]),{currentDomain:g}=(0,i.useMemo)(()=>(0,n.A)({carouselData:y,domain:p?.domain}),[y,p?.domain]),S=(0,i.useMemo)(()=>g?g.split(".")[0]:"",[g]),b=(0,i.useMemo)(()=>{let e=p?.trackedLink||p?.link||"";return(0,d.A)(e)??e},[p?.trackedLink,p?.link]),v=(0,i.useMemo)(()=>{let e=p?.richMetadata?.products?.[0],t=e?.offerSummary,a=!!(t?.price||t?.standardPrice),r=p?.linkDomain?.officialUser?.firstName;return{hasPrice:a,domainOwner:!!p?.closeupAttribution?.firstName||!!r,merchantName:p?.linkUserWebsite?.officialUser?.firstName||r||""}},[p?.richMetadata?.products,p?.linkDomain?.officialUser?.firstName,p?.closeupAttribution?.firstName,p?.linkUserWebsite?.officialUser?.firstName]),P=(0,i.useMemo)(()=>!!((v.merchantName||S)&&b),[v.merchantName,S,b]),k=(0,i.useMemo)(()=>{let e,t=0,a=0;return e=84+(p?.isEligibleForPdp&&v.hasPrice?18:0),t+=(p?.closeupUnifiedTitle||p?.gridTitle?23:0)+("enabled_idea_pin"!==f&&v.domainOwner?40:0),a+=64*!!P,e+=Math.max(t,a)},[p?.isEligibleForPdp,v.hasPrice,p?.closeupUnifiedTitle,p?.gridTitle,f,v.domainOwner,P]);if(!a)return{maxHeight:void 0};if(r)return{maxHeight:m?void 0:`calc(round(100vh, 1px) - 80px - ${k}px)`};let E=Math.round(window.innerHeight)-80-k;return{maxHeight:m&&!t?void 0:E}}},296377(e,t,a){a.d(t,{A:()=>s});var r=a(528989),i=a(376195),n=a(491149);let s=({showProductDetailPage:e,skipActivation:t})=>{let{checkExperiment:a}=(0,r.A)(),s=(0,n.qJ)(),{isAuthenticated:o}=(0,i._8)();return!!o&&!!s&&(e?a("closeup_dweb_blended_ui",{dangerouslySkipActivation:t}).anyEnabled:a("closeup_dweb_blended_ui_organic",{dangerouslySkipActivation:t}).anyEnabled)}},603856(e,t,a){function r(e,t){throw Error(t??`Unexpected value in assertNever: ${JSON.stringify(e)}`)}a.d(t,{A:()=>r})},626847(e,t,a){a.d(t,{H8:()=>s,Ss:()=>r,UP:()=>l,gm:()=>o,lT:()=>d,lh:()=>i,nr:()=>n});let r=Object.freeze({OTHER:0,CHROME:1,SAFARI:2,IE:3,FIREFOX:4,OPERA:5,EDGE:6}),i=e=>e?e.includes("Chrome")?r.CHROME:e.includes("Safari")?r.SAFARI:e.includes("Firefox")?r.FIREFOX:e.includes("Opera")?r.OPERA:e.includes("IE")?r.IE:e.includes("Edge")?r.EDGE:r.OTHER:r.OTHER;function n(e){return i(e)===r.SAFARI}function s(e){return i(e)===r.CHROME}function o(e){return i(e)===r.FIREFOX}function l(e){return i(e)===r.EDGE}function d(e){return i(e)===r.IE}},233944(e,t,a){a.d(t,{A:()=>i});var r=a(129625);let i=()=>(0,r.o)().logContextEvent},105476(e,t,a){a.d(t,{A:()=>p,b:()=>u});var r=a(829597),i=a.n(r),n=a(669897),s=a(605085);let o=(e,t)=>{let{condition:a,passingValue:r}=e,i=t[a];return void 0===i||i===r};var l=a(960363),d=a(892804);let u=Symbol("inlineFragmentSpread"),c=({conditionContext:e,fragmentName:t,mutableOutput:a,parentType:r,selections:n,legacyData:d,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y})=>{for(let g of n)switch(g.kind){case"ScalarField":{let{alias:e,name:t}=g;a[e??t]=(0,s.Kp)(t,r,d);break}case"LinkedField":{let{alias:n,name:o,concreteType:l,plural:u,selections:S}=g,b=n??o,v=(0,s.Nz)(d,r,g);if(null==v){a[b]=v;break}let P=(0,s.zu)({...v}),k=v;if(null!=P&&null!=v&&"object"==typeof v&&"id"in v&&"string"==typeof v.id){let e=m(v.id,P);"Intercepted"===e.kind&&!f.some(e=>e.id===v.id)&&(f.push({id:v.id,type:P}),y&&(k=e.data??v))}if(u){let r=(0,s.h6)({untypedInput:k,concreteType:l}),n=a[b];i()(!n||Array.isArray(n),"plural data must be an array"),a[b]=r?.filter(Boolean).map((a,r)=>{let i=n?.[r]??{};return c({conditionContext:e,fragmentName:t,mutableOutput:i,parentType:l,selections:S,legacyData:a,refetchInfo:p,paginationInfo:h,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}),i})}else{i()("object"==typeof k,`Value for ${o} must be an object${l?` with type ${l}`:""}, but a ${typeof k} is given`);let r=a[b]??{};"HasMissingData"===c({conditionContext:e,fragmentName:t,mutableOutput:r,parentType:l,selections:S,legacyData:k,refetchInfo:p,paginationInfo:h,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y})?a[b]=null:a[b]=r}break}case"InlineFragment":{let{abstractKey:r,type:n,selections:o}=g;if(i()(null!=n&&null===r,"We only support using inline fragment to refine to concrete types for now. Contact @jackhsu or @robertbalicki"),null==d)break;let l=d,u=(0,s.zu)(l);if(null!=u){let e=m(l.id,u);"Intercepted"===e.kind&&(f.some(e=>e.id===l.id)||f.push({id:l.id,type:u}),((0,s.ZH)(l)||y)&&(l=e.data??d))}if(null!=u&&(0,s.GM)(n,u)&&"HasMissingData"===c({conditionContext:e,fragmentName:t,mutableOutput:a,parentType:n,selections:o,legacyData:l,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}))return"HasMissingData";break}case"Condition":{let{selections:i}=g;if(o(g,e)&&"HasMissingData"===c({conditionContext:e,fragmentName:t,mutableOutput:a,parentType:r,selections:i,legacyData:d,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}))return"HasMissingData";break}case"FragmentSpread":(0,l.LI)(a,{kind:"LegacyData",singularLegacyData:d,refetchInfo:p,paginationInfo:h});break;case"ClientExtension":if("HasMissingData"===c({conditionContext:e,fragmentName:t,mutableOutput:a,parentType:r,selections:g.selections,legacyData:d,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}))return"HasMissingData";break;case"InlineDataFragmentSpread":{let t={},{selections:i,name:n}=g;if("HasMissingData"===c({conditionContext:e,fragmentName:n,mutableOutput:t,parentType:r,selections:i,legacyData:d,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}))return"HasMissingData";a[u]||(a[u]={}),a[u][n]=t;break}case"RequiredField":if(c({conditionContext:e,fragmentName:t,mutableOutput:a,parentType:r,selections:[g.field],legacyData:d,paginationInfo:h,refetchInfo:p,getDataFromRedux:m,interceptedEntities:f,isInterceptedEntitiesExperimentEnabled:y}),null==a[g.field.alias??g.field.name])if("THROW"!==g.action)return"HasMissingData";else throw Error("Required field is null or undefined");break;case"Defer":case"Stream":case"ActorChange":case"FlightField":case"ModuleImport":case"RelayResolver":case"ClientEdge":throw Error(`The selection type '${g.kind}' is not supported yet. Contact @jackhsu or @robertbalicki`);default:throw Error("Unexpected selection type")}return"NoMissingData"},h=new Set;function p({conditionContext:e,fragment:t,legacyData:a,paginationInfo:r,refetchInfo:o,getDataFromRedux:l,interceptedEntities:u,isInterceptedEntitiesExperimentEnabled:p}){let m,f=(0,n.getFragment)(t);try{m=function({conditionContext:e,fragment:t,legacyData:a,paginationInfo:r,refetchInfo:n,getDataFromRedux:o,interceptedEntities:l,isInterceptedEntitiesExperimentEnabled:d}){let u=(0,s.zu)(a),h=a;if(null!=u){let e=o(a.id,u);e&&"Intercepted"===e.kind&&!l.some(e=>e.id===a.id)&&(l.push({id:a.id,type:u}),d&&(0,s.ZH)(a)&&(h=e.data??a))}if(null==t.abstractKey){let e=null!=h?(0,s.zu)(h):null;null!=e&&i()((0,s.GM)(t.type,e),`fragment data type '${t.type}' does not match legacy data type '${e}'. See http://pinch.pinadmin.com/fragment-data-type-does-not-match-legacy-data-type.`)}let p={};return"NoMissingData"===c({conditionContext:e,fragmentName:t.name,mutableOutput:p,parentType:t.type,selections:t.selections,legacyData:h,paginationInfo:r,refetchInfo:n,getDataFromRedux:o,interceptedEntities:l,isInterceptedEntitiesExperimentEnabled:d})?p:null}({conditionContext:e,fragment:f,legacyData:a,paginationInfo:r,refetchInfo:o,getDataFromRedux:l,interceptedEntities:u,isInterceptedEntitiesExperimentEnabled:p})}catch(t){throw h.has(f.name)||(h.add(f.name),(0,d.GV)("autoLegacyAdapter.erroredReadResults",{sampleRate:1,tags:{fragmentName:f.name,rootId:a.id,rootType:a.type,url:window.location.href,isAuth:e.isAuth}})),t}return m??null}},605085(e,t,a){a.d(t,{zw:()=>k,ZH:()=>A,GM:()=>D,Kp:()=>v,zu:()=>L,Nz:()=>E,h6:()=>P});var r=a(829597),i=a.n(r),n=a(270097);let s=function(e){if(e.images){let t={};for(let[a,r]of Object.entries(e.images))r?t[a]={url:r.url??null,width:r.width??null,height:r.height??null,dominantColor:r.dominantColor??void 0}:t[a]=null;return t}let t={},a=e.dominant_color;if(e.image_square_url&&(t["136x136"]={url:e.image_square_url,width:e.image_square_size_pixels?.width??void 0,height:e.image_square_size_pixels?.height??void 0,dominantColor:a??void 0}),e.image_medium_url){let r=e.image_medium_size_pixels?.width,i=e.image_medium_size_pixels?.height;r&&r<=236?t["236x"]={url:e.image_medium_url,width:r??void 0,height:i??void 0,dominantColor:a??void 0}:r&&r<=474?t["474x"]={url:e.image_medium_url,width:r??void 0,height:i??void 0,dominantColor:a??void 0}:t["170x"]={url:e.image_medium_url,width:r??void 0,height:i??void 0,dominantColor:a??void 0}}if(e.image_large_url){let r=e.image_large_size_pixels?.width,i=e.image_large_size_pixels?.height;t["736x"]={url:e.image_large_url,width:r??void 0,height:i??void 0,dominantColor:a??void 0},t.orig={url:e.image_large_url,width:r??void 0,height:i??void 0,dominantColor:a??void 0}}return Object.keys(t).length>0?t:null},o={vDASHHEVCSLCONTROL:"V_DASH_HEVC_SL_CONTROL",vHLSHEVC2SEC:"V_HLS_HEVC_2_SEC",vHLSHEVCSLCONTROL:"V_HLS_HEVC_SL_CONTROL",vHLSSINGLEFILECMAFEXP:"V_HLS_SINGLE_FILE_CMAF_EXP",vHLSSINGLEFILECONTROL:"V_HLS_SINGLE_FILE_CONTROL",vHLSSINGLEFILETSEXP:"V_HLS_SINGLE_FILE_TS_EXP",vHLSSLCONTROL:"V_HLS_SL_CONTROL",vHLSV3:"V_HLSV3",vHLSV3EXP:"V_HLSV3_EXP",vHLSV3MOBILE:"V_HLSV3_MOBILE",vHLSV3WEB:"V_HLSV3_WEB",vHLSV4:"V_HLSV4",vLOWBITRATEEXPHLSHEVCCONTROL:"V_LOW_BITRATE_EXP_HLS_HEVC_CONTROL",vLOWBITRATEEXPHLSHEVCLOB:"V_LOW_BITRATE_EXP_HLS_HEVC_LOB",vLOWBITRATEEXPHLSHEVCLQS:"V_LOW_BITRATE_EXP_HLS_HEVC_LQS"},l=/(\d\d0P)(\d\d0K)/,d=/QVBR(8|10)/,u=/(EXP\d?|ADSHQ|AVC|DASH|MANI|HIGHQUAL|HEVC|HLS|H265|H264|720P?|MP4|ENABLED|CONTROL|PROD|T\d|Q?VBR\d*|AUTOABR|MEDIACONVERT|QUALITY|REARRANGED|REMHIGHRES|VISIONULAR|480$|640$|V2$|\dSEC$|\d\d0P\d\d0K$)/g,c=/^v/,h=/[A-Z]/g,p=/^_/,m=e=>e.replace(h,e=>`_${e.toLowerCase()}`).replace(p,""),f=["actionOptions","feedbackText","selectedItem","savedInfo","undoCallbackProps"],y=["boardId","localPinId","showFeedback","showFeedbackOverlay","sectionId","subTitle","viewType","viewParameter"],g=(e,t)=>{if(y.includes(e))return e;switch(e){case"entityId":return"id";case"__id":return i()(t.node_id,"node_id is missing. Please only select the __id field on objects which have an id field."),"node_id";default:return m(e)}},S=e=>"StoryPinPage"===e||"StoryPinImageBlock"===e,b=(e,t,a)=>{if(S(a)){if("images"===e)return"image";else if("imagesAdjusted"===e)return"image_adjusted"}if("PinTagChipImagesPerSpec"===a&&"image"===e)return"images";if("VideoDetail"===t)return o[e]??e.replace(u,"_$1").replace(l,"$1_$2").replace(d,"QVBR_$1").replace("ADSHQ","ADS_HQ").replace("HIGHQUAL","HIGH_QUAL").replace("REMHIGHRES","REM_HIGH_RES").replace(c,"V");if(f.includes(e))return e;if("AnalyticsTopPinsData"===a||"AnalyticsTopProductGroupsData"===a||"AnalyticsTopBoardsData"===a)switch(e){case"dateAvailability":return m(e);case"video10sView":return"VIDEO_10S_VIEW";case"quartile95PercentView":return"QUARTILE_95_PERCENT_VIEW";default:return m(e).toUpperCase()}if("AnalyticsDateAvailabilityMetricData"===a)switch(e){case"video10sViewReformatted":return"VIDEO_10S_VIEW";case"quartile95PercentViewReformatted":return"QUARTILE_95_PERCENT_VIEW";default:return m(e).toUpperCase()}if("ProductGroup"===a&&"coverImagesArray"===e)return"cover_images";switch(e){case"reactionCountsData":return"reaction_counts";case"videoDataV2":return"video";case"formattedCloseupDescription":return"formatted_description";case"annotationsWithLinksArray":return"annotations_with_links";default:return m(e)}},v=(e,t,a)=>{if("Video"===t&&"duration"===e)return a?.duration!=null?a.duration:Object.values(a?.video_list||{}).find(e=>e?.duration!=null)?.duration;if("__typename"===e)return t??function(e){if(!e)return null;if("string"==typeof e.type)return(0,n.Dh)(e.type);if("number"==typeof e.block_type){let t=e.block_type.toString();return t in C?C[t]:null}return null}(a);if("AnalyticsSummaryMetricsData"===t&&a)switch(e){case"video10sView":case"video10sViewFloat":return a.VIDEO_10S_VIEW;case"quartile95PercentView":return a.QUARTILE_95_PERCENT_VIEW;default:let r=g(e.replace("Float",""),a).toUpperCase();return a?.[r]}if("MetricStatusesReformatted"===t&&a)switch(e){case"video10sView":return a.VIDEO_10S_VIEW;case"quartile95PercentView":return a.QUARTILE_95_PERCENT_VIEW;default:let i=g(e,a).toUpperCase();return a?.[i]}if("AnalyticsDeltaMetricData"===t&&a){let t=g(e,a).toUpperCase();return a?.[t]}if("ProductGroup"===t&&a&&"entityIdGraphql"===e)return a.id;var s=a?.[g(e,a)];switch(e){case"reactionType":return"string"==typeof s?Number(s):s;case"campaignId":case"pinPromotionId":return"number"==typeof s?String(s):s;default:return s}},P=({untypedInput:e,concreteType:t})=>{if(!e)return null;switch(i()("object"==typeof e,"legacy data must be an object"),t){case"AnalyticsMetricSeriesTypeData":if(Array.isArray(e))return e;return Object.entries(e).map(([e,t])=>({key:e,series:t}));case"AnnotationsWithLinks":return Object.entries(e).map(([e,t])=>({name:t.name,url:t.url}));case"MessageReactions":if(Array.isArray(e)&&e.length>0)return e.flatMap(e=>Object.keys(e).map(t=>({user_id:t,reaction_text:e[t]})));return null;case"ReactionCountModel":return Object.entries(e).map(([e,t])=>({reaction_type:e,reaction_count:t}));case"PinThroughProperties":case"ThroughProperties":case"TrackingParamsMap":return Object.entries(e).map(([e,t])=>({key:e,data:t}));case"DescriptionSpecDetail":if(Array.isArray(e)){let t=[];return e.forEach(e=>{if(e)for(let a of Object.entries(e))t.push({key:a[0],value:a[1]})}),t}return Object.entries(e).map(([e,t])=>({key:e,value:t}));default:if(Array.isArray(e))return e;return Object.entries(e).map(([e,t])=>({key:e,value:t}))}},k=(e,t,a,r)=>{if("data"===e&&null==a)return r;let i=b(e,t,a);return r?.[i]??r?.[e]},E=(e,t,a)=>{let{args:r,name:n,plural:o}=a;if("PinTagChipImagesPerSpec"===t&&"image"===n)return e?.images?.["750x"];let l=e?.[b(n,a.concreteType,t)];if("images"===n&&"Pin"===t&&!l){let t=s(e);t&&(l=t)}if(!l)return l;if("MultiPinShare"===t&&"pins"===n)return Array.isArray(l)?{kind:"pin_pins_connection_container",type:"PinPinsConnectionContainer",connection:{edges:l.map(e=>({node:e}))}}:null;if("collaboratingUsers"===n){let t=e?.collaborating_users;return null==t?null:{kind:"user_collaborating_users_connection_container",connection:{edges:t.map(e=>({node:e}))}}}let d=(({args:e,name:t})=>{let a=e.find(e=>e.name===t);return a&&"string"==typeof a.value?a.value:null})({args:r??[],name:"spec"});if(d){if(i()("object"==typeof l,"value must be an object"),S(t)){let{dominant_color:e,images:t}=l;if(!t)return t;i()("object"==typeof t,"images must be an object");let a=t["orig"===d?"originals":d];return a&&e?{...a,dominant_color:e}:a}return o&&Array.isArray(l)?l.map(e=>e[d]).filter(e=>null!=e):l[d]}return l},T={HeadingBlock:"StoryPinHeadingBlock",IngredientBlock:"StoryPinIngredientBlock",InstantContentURLNavigateAction:"InstantContentActionUrlNavigate",InstantContentHeaderBlock:"InstantContentHeader",InstantContentParagraphBlock:"InstantContentParagraph",InstantContentTextBlock:"InstantContentText",InstantContentHeadingBlock:"InstantContentHeading",InstantContentImageBlock:"InstantContentImage",InstantContentVideoBlock:"InstantContentVideo",InstantContentTableBlock:"InstantContentTable",InstantContentGroupBlock:"InstantContentGroup",InstantContentOrderedListBlock:"InstantContentOrderedList",InstantContentUnorderedListBlock:"InstantContentUnorderedList",InstantContentSectionBlock:"InstantContentSection",InstantContentSeparatorBlock:"InstantContentSeparator",InstantContentUserBlock:"InstantContentUser",InstantContentWebBlock:"InstantContentWeb",InstantContentPromotedWebBlock:"InstantContentPromotedWeb",LinkBlock:"StoryPinLinkBlock",ParagraphBlock:"StoryPinParagraphBlock",SupplyBlock:"StoryPinSupplyBlock",TextBlock:"StoryPinTextBlock",DescriptionString:"FormattedDescriptionParagraphComponent",DescriptionHeader:"FormattedDescriptionHeaderComponent",DescriptionPoints:"FormattedDescriptionPointsComponent",DescriptionStringBold:"FormattedDescriptionBoldComponent",DescriptionTable:"FormattedDescriptionTableComponent",DescriptionSpecs:"FormattedDescriptionSpecsComponent",RichPinProductMetadata:"RichProductMetadata",ConversationMessage:"Message"},_={tempmessage:"message"},w=["article","board","pin","story"],A=e=>"schema"in e&&"string"==typeof e.schema&&w.includes(e.schema),D=(e,t)=>(T[e]??e).toLowerCase()===(_[t]??t),C={0:"StoryPinParagraphBlock",1:"StoryPinHeadingBlock",2:"StoryPinImageBlock",3:"StoryPinVideoBlock",4:"StoryPinLinkBlock",5:"StoryPinIngredientBlock",6:"StoryPinSupplyBlock",7:"StoryPinListBlock",8:"StoryPinKeyValueBlock",9:"StoryPinTextBlock",11:"StoryPinMusicBlock",12:"StoryPinMentionStickerBlock",13:"StoryPinProductStickerBlock",14:"StoryPinStaticStickerBlock",15:"StoryPinAnimatedStickerBlock",16:"StoryPinCommentReplyBlock",17:"StoryPinVirtualTryOnMakeupStickerBlock",18:"StoryPinAdBlock",19:"StoryPinGenericInteractiveStickerBlock"},R=/_/g,L=e=>{if("schema"in e&&"string"==typeof e.schema)return e.schema.toLowerCase();if("string"==typeof e.type)return e.type.replace(R,"").toLowerCase();if("number"==typeof e.block_type){let t=e.block_type.toString();return t in C?C[t].toLowerCase():void 0}}},20711(e,t,a){a.d(t,{A:()=>function e(t,a,o=null){let l={};return!function t(a,o,l,d){let u=function(e,t=null){let a=e.map(e=>"RequiredField"===e.kind?e.field:e),[r,i]=a.reduce((e,t)=>("InlineFragment"===t.kind?e[0].push(t):e[1].push(t),e),[[],[]]);if(1===r.length){let[e,a]=s(i);if(0===a.length){let[a,i]=s(r[0].selections),n=[...e,...a];return 0===n.length?{kind:"Uncategorized"}:{kind:"InlineFragmentWithTypename",typenameAliases:n,selections:i,concreteType:r[0].type,remainingPathCount:t}}}else if(1===a.length&&a[0]?.kind==="Condition"){let e=a[0];if(!e||"Condition"!==e.kind)throw Error("Error on @skip/@include directive");return{kind:"OnlyConditionWrapper",selections:e.selections,remainingPathCount:t}}else if(1===a.length&&"LinkedField"===a[0].kind){let e=a[0],r=e.concreteType??null;if(e.plural){let[a,i]=s(e.selections);if(i.length>0&&i.every(e=>"FragmentSpread"===e.kind))return{kind:"PluralLinkedFieldWithFragmentSpread",name:e.name,concreteType:r,typenameAliases:a,selections:i};if(1!==t)return{kind:"Uncategorized"}}if(null==r)return{kind:"OnlyLinkedFieldAndTypename",selections:e.selections,name:e.name,concreteTypeAndAliases:null,remainingPathCount:null==t?null:t-1};let[i,n]=s(e.selections);if(1===t){let t=e.alias??e.name,{pageInfoSelection:a,edgeSelection:r}=function(e){if(0===e.length||e.length>2||e.some(e=>"LinkedField"!==e.kind))throw Error("Unexpected selections");let t=e.reduce((e,t)=>{if("pageInfo"===t.name){if(null!==e.pageInfoSelection)throw Error("Expected only one pageInfo selection");e.pageInfoSelection=t}else{if(null!==e.edgeSelection)throw Error("Expected only one edge selection");e.edgeSelection=t}return e},{pageInfoSelection:null,edgeSelection:null});if(t.edgeSelection&&!t.edgeSelection.selections.find(e=>"node"===e.name))throw Error("Expected to find a node field inside of edges");return{pageInfoSelection:t.pageInfoSelection,edgeSelection:t.edgeSelection}}(n);if(null===r)throw Error("No edges found in connection field");let s=r.alias??r.name,{concreteType:o}=e;if(null==o&&i.length>0)throw Error("No concrete type found in connection field, so we cannot have __typename");let l=null!=o?{concreteType:o,typenameAliases:i}:null;return{kind:"ConnectionFieldAndTypename",selections:r.selections.filter(e=>"ScalarField"!==e.kind||"cursor"!==e.name),pageInfoSelection:a,nameOrAliasOfEdgesField:s,nameOrAliasOfConnectionField:t,concreteTypeAndAliases:l}}return{kind:"OnlyLinkedFieldAndTypename",selections:n,name:e.name,concreteTypeAndAliases:{concreteType:r,typenameAliases:i},remainingPathCount:null==t?null:t-1}}else if(a.length>0&&a.every(e=>"FragmentSpread"===e.kind))return{kind:"OnlyFragmentSpread"};return{kind:"Uncategorized"}}(a,d);switch(u.kind){case"OnlyConditionWrapper":{let{selections:e,remainingPathCount:a}=u;t(e,o,l,a);break}case"InlineFragmentWithTypename":{let{concreteType:e,typenameAliases:a,selections:r,remainingPathCount:i}=u;a.forEach(t=>o[t]=e),t(r,o,l,i);break}case"OnlyFragmentSpread":(0,n.LI)(o,l);break;case"OnlyLinkedFieldAndTypename":{let{name:e,selections:a,concreteTypeAndAliases:r,remainingPathCount:i}=u,n={};if(o[e]=n,r&&r.typenameAliases.length>0){let{concreteType:e,typenameAliases:t}=r;for(let a of t)n[a]=e}t(a,n,l,i);break}case"ConnectionFieldAndTypename":{let{nameOrAliasOfEdgesField:t,nameOrAliasOfConnectionField:a,pageInfoSelection:r,selections:i,concreteTypeAndAliases:n}=u;if("PaginationLegacyData"!==l.kind)throw Error("Error, expected a PaginationLegacyData kind for this query");let s={[t]:l.paginationLegacyData.map(t=>e(i,{kind:"LegacyData",refetchInfo:l.refetchInfo,paginationInfo:l.paginationInfo,singularLegacyData:t}))};if(r&&l.paginationInfo&&(s[r.alias??r.name]=null),null!=n){let{concreteType:e,typenameAliases:t}=n;for(let a of t)s[a]=e}o[a]=s;break}case"PluralLinkedFieldWithFragmentSpread":{let{name:e,concreteType:t,typenameAliases:a}=u;if("LegacyData"!==l.kind)throw Error("Expected LegacyData for PluralLinkedFieldWithFragmentSpread");let{singularLegacyData:r,refetchInfo:s,paginationInfo:d}=l,c=(0,i.zw)(e,t,null,r),h=(0,i.h6)({untypedInput:c,concreteType:t}),p=h?.map(e=>{let r={};if(t&&a.length>0)for(let e of a)r[e]=t;return(0,n.LI)(r,{kind:"LegacyData",singularLegacyData:e,refetchInfo:s,paginationInfo:d}),r})??[];o[e]=p;break}case"Uncategorized":throw Error("The query passed to useLazyLoadQueryOrLegacy contained unsupported/uncategorized elements. Please simplify the query.");default:(0,r.A)(u,"Unexpected category")}}(t,l,a,o),l}});var r=a(603856),i=a(605085),n=a(960363);function s(e){return e.reduce((e,t)=>("ScalarField"===t.kind&&"__typename"===t.name?e[0].push(t.alias??t.name):e[1].push(t),e),[[],[]])}},657804(e,t,a){a.d(t,{n:()=>i,z:()=>n});var r=a(960363);function i(e){if(Array.isArray(e)){let t=e[0];if(null==t)return{kind:"PluralLegacy",data:[],paginationInfo:null,refetchInfo:null};if(null!=t.__fragments)return{kind:"GraphQL",data:e};let a=(0,r.s8)(t);if(null!=a)return{kind:"PluralLegacy",data:e.map(e=>(e=>{let t=(0,r.Me)(e);if("LegacyData"===t.kind)return t.singularLegacyData;throw Error("Unexpected plural object")})(e)),paginationInfo:a.paginationInfo,refetchInfo:a.refetchInfo};throw Error("Expected either __fragments or [legacyDataSymbol]")}let t=(0,r.s8)(e);if(null!=t&&"LegacyData"===t.kind){let{singularLegacyData:e,refetchInfo:a,paginationInfo:r}=t;return{kind:"SingularLegacy",data:e,refetchInfo:a,paginationInfo:r}}if(e.__fragments)return{kind:"GraphQL",data:e};if("GraphQL"===e.type)return{kind:"GraphQL",data:e.data};if("Legacy"===e.type){let{data:t}=e;return Array.isArray(t)?{kind:"PluralLegacy",data:t,refetchInfo:null,paginationInfo:null}:{kind:"SingularLegacy",data:t,refetchInfo:null,paginationInfo:null}}if(null!=t&&"PaginationLegacyData"===t.kind){let{paginationLegacyData:e,refetchInfo:a,paginationInfo:r}=t;return{kind:"PaginationLegacyData",paginationLegacyData:e,refetchInfo:a,paginationInfo:r}}throw Error("Invalid value")}function n(e){return i(e).kind}},960363(e,t,a){a.d(t,{LI:()=>s,Me:()=>n,s8:()=>i});let r=Symbol("legacyData");function i(e){return e[r]}function n(e){return e[r]}function s(e,t){return e[r]=t,e}},270097(e,t,a){a.d(t,{$E:()=>d,$Z:()=>l,A:()=>s,Dh:()=>c,sk:()=>o});var r=a(859471),i=a(376195),n=a(491149);let s=()=>{let{isAuthenticated:e}=(0,i._8)(),t=(0,n.qJ)();return(0,r.useMemo)(()=>({isAuth:!!e,isDesktop:t}),[e,t])},o={" $fragmentSpreads":void 0," $fragmentType":void 0};function l(e){let{isAuthParam:t,isDesktop:a,authDesktopQuery:r,authMobileQuery:i,unauthDesktopQuery:n,unauthMobileQuery:s}=e;return t?a?r:i:a?n:s}function d(e){let{isAuthParam:t,isDesktop:a,authDesktopFragment:r,authMobileFragment:i,unauthDesktopFragment:n,unauthMobileFragment:s}=e;return t?a?r:i:a?n:s}let u=/(?:^|_)([a-z])/g;function c(e){return e.replace(u,(e,t)=>t.toUpperCase())}},926822(e,t,a){a.d(t,{A:()=>l});var r=a(859471),i=a(105476),n=a(20711),s=a(270097),o=a(528989);let l=function({fragment:e,dataKey:t,validateSingularLegacy:a,getDataFromRedux:l}){let d=(0,s.A)(),u=(0,o.A)().checkExperiment("web_auto_legacy_adapter_intercepted_entities").anyEnabled;return(0,r.useMemo)(()=>{if(t?.kind==="SingularLegacy"&&a(t)){let{data:a,refetchInfo:r,paginationInfo:n}=t;return[(0,i.A)({conditionContext:d,fragment:e,legacyData:a,paginationInfo:n,refetchInfo:r,getDataFromRedux:l,interceptedEntities:[],isInterceptedEntitiesExperimentEnabled:u})]}if(t?.kind==="PluralLegacy"){let{data:a,refetchInfo:r,paginationInfo:n}=t,s=[],o=[];return a.forEach(t=>{let a=(0,i.A)({conditionContext:d,fragment:e,legacyData:t,paginationInfo:n,refetchInfo:r,getDataFromRedux:l,interceptedEntities:o,isInterceptedEntitiesExperimentEnabled:u});s?.push(a)}),s}if(t?.kind==="PaginationLegacyData"){let a=e?.metadata?.connection?.[0]?.path?.length??null;return[(0,n.A)(e.selections,t,a)]}return null},[t?.kind==="PaginationLegacyData"?t.paginationLegacyData:t?.data])}},192176(e,t,a){a.d(t,{A:()=>i});var r=a(859471);function i(e,t){let a=(0,r.useRef)(null);if(null!=e){if(null==a.current)a.current=e;else if(a.current!==e)throw Error(`${t()}: reference type mismatch: expected ${a.current}, but received ${e}.`)}}},900565(e,t,a){a.d(t,{A:()=>y});var r=a(224989),i=a(669897),n=a(603856),s=a(192176),o=a(657804),l=a(926822),d=a(309095);let u=function(e,t){let{getDataFromRedux:a}=(0,d.A)(),r=(0,i.getFragment)(e),n=t?(0,o.n)(t):null;if(n?.kind==="GraphQL")return{dataKey:n,autoLegacyAdapterData:null};let s=(0,l.A)({fragment:r,dataKey:n,validateSingularLegacy:()=>!0,getDataFromRedux:a});return n?{dataKey:n,autoLegacyAdapterData:s}:null};var c=a(859471),h=a(371955),p=a(528989),m=a(316669);let f=()=>{},y=function(e,t){let a=performance.now(),o=(()=>{let e=(0,m.AJ)(),{setRmaData:t}=(0,h.Ve)(),{checkExperiment:a}=(0,p.A)(),r=(0,c.useCallback)((a,r,n,s)=>{let o=performance.now()-r,l=(0,i.getFragment)(a),d=n&&"id"in n&&"string"==typeof n.id?n.id:null;d&&t({id:d,path:e,fragmentName:l.name,executionTime:o,newData:s})},[e,t]);return(0,h.IK)(e)&&a("web_render_performance_rma").anyEnabled?r:f})(),l=(0,i.getFragment)(e),d=u(e,t);if((0,s.A)(d?.dataKey.kind,()=>l.name),null==d)return null;let{dataKey:y,autoLegacyAdapterData:g}=d;switch(y.kind){case"SingularLegacy":return o(e,a,y.data,g?.[0]),g?.[0];case"PluralLegacy":return o(e,a,y.data,g),g;case"GraphQL":return(0,r.useFragment)(e,y.data);case"PaginationLegacyData":if(Array.isArray(t))throw Error("Unexpected Plural fragment");if(null!=(l?.metadata?.connection?.[0]?.path?.length??null))throw Error("Unexpected fragment containing a @connection directive. You should read this fragment with usePaginationFragmentOrLegacy instead.");return g?.[0];default:return(0,n.A)(y,"Unexpected case")}}},309095(e,t,a){a.d(t,{A:()=>n});var r=a(859471),i=a(106386);function n(){let e=(0,r.use)(i.ty),t=e?.store?.getState();return{getDataFromRedux:(0,r.useCallback)((e,a)=>{let r=null;switch(a){case"pin":r=t?.pins?.[e];break;case"story":r=t?.stories?.[e];break;case"board":r=t?.boards?.[e];break;case"article":case"explorearticle":case"todayarticle":r=t?.articles?.[e];break;default:r=null}return r?{kind:"Intercepted",data:r}:{kind:"NotIntercepted"}},[t])}}},757893(e,t,a){a.d(t,{A:()=>s});var r=a(528989),i=a(376195),n=a(491149);let s=({skipExpActivation:e=!1}={})=>{let{checkExperiment:t}=(0,r.A)(),a=(0,n.qJ)(),{isAuthenticated:s}=(0,i._8)();return s&&a?t("closeup_dweb_adaptive_images",{dangerouslySkipActivation:e}):{anyEnabled:!1,group:""}}},605563(e,t,a){function r(e,t){return`${e}#${t}`}function i(e,t,a){return`${r(e,t)}${a.length>0?`#[${a.join("][")}]`:""}`}a.d(t,{SB:()=>r,tP:()=>i})},148322(e,t,a){a.d(t,{A:()=>r});let r=e=>{switch(e){case"BR":case"MX":case"AR":case"CL":case"CO":return"LatAm";case"US":return"US";default:return"OTHER"}}},661399(e,t,a){a.d(t,{d1:()=>h,yQ:()=>c,S_:()=>p});var r=a(859471),i=a(767216),n=a(760560),s=a(624731),o=a(562615);let l=()=>a.e("16425").then(a.bind(a,760560)),{Provider:d,get:u}=(0,i.A)("IdeaPinVideoPlayer");function c({children:e}){let[t,a]=(0,s.A)(l,n.initialState),i=(0,r.useMemo)(()=>({dispatch:a,ideaPinVideoPlayerControls:t}),[a,t]);return(0,o.jsx)(d,{value:i,children:e})}function h(){let{dispatch:e}=u();return(0,r.useMemo)(()=>({updateSeekTime:(t,a)=>{e({type:"UPDATE_SEEK_TIME",payload:{seekTime:t,pinId:a||""}})},clearSeekTime:t=>{e({type:"CLEAR_SEEK_TIME",payload:{seekTime:void 0,pinId:t||""}})}}),[e])}function p(){let{ideaPinVideoPlayerControls:e}=u();return e}},760560(e,t,a){a.r(t),a.d(t,{default:()=>i,initialState:()=>r});let r={seekTimes:{},currentProgressInfo:{currentTime:0,duration:0}};function i(e=r,t){switch(t.type){case"UPDATE_SEEK_TIME":return{...e,seekTimes:{...e.seekTimes,[t.payload.pinId]:t.payload.seekTime}};case"CLEAR_SEEK_TIME":return{...e,seekTimes:{}};default:return e}}},852758(e,t,a){function r(e){try{return decodeURIComponent(e)}catch{return null}}a.d(t,{A:()=>r})},624731(e,t,a){a.d(t,{A:()=>i});var r=a(859471);function i(e,t){let a=(0,r.useRef)([]),[i,n]=(0,r.useState)(),[s,o]=(0,r.useReducer)(i??(()=>t),t),l=(0,r.useCallback)(t=>{i?o(t):(a.current.length||e().then(e=>{n(()=>e.default)}),a.current=[...a.current,t])},[e,i]);return(0,r.useEffect)(()=>{i&&(a.current.forEach(o),a.current=[])},[i]),[s,l]}},507120(e,t,a){a.d(t,{A:()=>o});var r=a(859471);let i=()=>()=>{},n=()=>!1,s=()=>!0,o=()=>(0,r.useSyncExternalStore)(i,n,s)},892098(e,t,a){a.d(t,{A:()=>_});var r=a(859471),i=a(512850),n=a(836737),s=a(296377),o=a(233944),l=a(47998),d=a(538346),u=a(528989),c=a(376195),h=a(135323),p=a(431803),m=a(989715),f=a(143630),y=a(434318),g=a(661373),S=a(257470),b=a(208762),v=a(456030),P=a(562615);function k(e,t,a){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let E=e=>"string"==typeof e?e:Array.isArray(e)?e[0].src?[{...e[0],src:e[0].src}]:e:e;class T extends r.PureComponent{constructor(...e){super(...e),k(this,"state",{canPlayVideo:!1,isManifestParsed:!1,playbackState:g.G.DEFAULT,videoStartTime:this.props.seekTime||0}),k(this,"errorRetryCount",1),k(this,"firstFragBuffered",!1),k(this,"hasPlaybackStarted",!1),k(this,"hasVideoSessionStarted",!1),k(this,"hasVideoSessionEnded",!1),k(this,"hls",null),k(this,"fragStartupTime",{}),k(this,"lastLevelSwitchKbps",null),k(this,"lastStallTime",null),k(this,"lastPauseTime",null),k(this,"logSessionStartOnNextPlay",!1),k(this,"playerId",""),k(this,"videoSessionId",""),k(this,"videoVisibleTime",null),k(this,"nearViewportObserver",null),k(this,"isNearViewport",!1),k(this,"playbackPerformance",{canPlayTime:null,detailedErrors:"",downloadedKiloBytes:0,errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:"string"==typeof this.props.src?this.props.src:this.props.src&&this.props.src.length>0?this.props.src[0].src:"",totalStallDurationMs:0,totalPauseDurationMs:0,userAgent:this.props.userAgent,videoCreatedTime:null,webBrowser:this.props.webBrowser,webBrowserVersion:this.props.webBrowserVersion}),k(this,"setupNearViewportObserver",()=>{!("u"<typeof window)&&window.IntersectionObserver&&(this.cleanupNearViewportObserver(),this.nearViewportObserver=new IntersectionObserver(e=>{e.forEach(e=>{let t=this.isNearViewport,a=e.isIntersecting||e.intersectionRatio>0;this.isNearViewport=a,a&&!t&&this.handleNearViewport()})},{root:null,rootMargin:"500px",threshold:[0,.1,.5,1]}),this.videoPlayerRef?.video&&this.nearViewportObserver.observe(this.videoPlayerRef.video))}),k(this,"handleNearViewport",()=>{let{appInFocus:e}=this.props;e&&!this.hls&&this.videoPlayerRef?.video&&this.initializeHls()}),k(this,"cleanupNearViewportObserver",()=>{this.nearViewportObserver&&(this.nearViewportObserver.disconnect(),this.nearViewportObserver=null,this.isNearViewport=!1)}),k(this,"initializeHls",()=>{this.destroyHls();let{src:e,hlsConfig:t,startupLatencyConfigEnabled:a,isMobile:r}=this.props,n=(0,y.A)(a,r),s=new i.Ay(a?n.hlsConfig:t),o=E(e);s.loadSource(o),this.videoPlayerRef&&s.attachMedia(this.videoPlayerRef.video),s.on(i.Ay.Events.FRAG_BUFFERED,this.handleHlsFragBuffered),s.on(i.Ay.Events.FRAG_CHANGED,this.handleHlsFragChanged),s.on(i.Ay.Events.FRAG_LOADING,this.handleHlsFragLoading),s.on(i.Ay.Events.FRAG_LOADED,this.handleHlsFragLoaded),s.on(i.Ay.Events.MANIFEST_PARSED,()=>{this.setState({isManifestParsed:!0})}),s.on(i.Ay.Events.LEVEL_SWITCHED,this.handleHlsLevelSwitched),s.on(i.Ay.Events.ERROR,this.handleHlsError),this.hls=s}),k(this,"destroyHls",()=>{let{startupLatencyPredictive:e}=this.props;if(e)this.cleanupNearViewportObserver(),this.hls&&(this.hls.destroy(),this.hls=null),this.firstFragBuffered=!1,this.fragStartupTime={};else{let{hls:e}=this;e&&e.destroy()}}),k(this,"addSegment",e=>{let{segments:t}=this.playbackPerformance,a=t&&t[t.length-1];if(this.hls&&t.length&&a&&a.uri!==e.url){this.updateWatchDurationForCurrentSegment();let a=this.videoPlayerRef&&this.videoPlayerRef.video,r=this.hls&&this.hls.levels||{},i="number"==typeof e.level?r[e.level]:{},n=this.fragStartupTime[e.url],s=-1;n&&n.startLoadTime&&n.endLoadTime&&(s=n.endLoadTime-n.startLoadTime);let o={indicatedKbps:i.bitrate/1e3,duration:e.duration,level:e.level,lastStartPlayTime:this.getCurrentVideoTime(),numServerAddressChange:-1,observedKbps:this.hls&&this.hls.bandwidthEstimate/1e3||-1,playbackStartDate:Date.now(),serverAddress:"",sn:e.sn,sourceWidth:i.width,sourceHeight:i.height,startupTimeMs:s,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:a&&a.clientWidth||-1,viewportHeight:a&&a.clientHeight||-1,watchedDurationMs:0};t.push(o)}}),k(this,"initializeSegments",e=>{let{contextLogData:t={}}=this.props,{is_closeup_video:a=!1}=t,{segments:r}=this.playbackPerformance;if(!r.length){if(!this.hls||!this.videoPlayerRef||!this.videoPlayerRef.video||!e)return void(0,f.Hb)("initializeSegmentsFailed",!0,a);if(!r.length&&"number"==typeof e.level){let t=this.videoPlayerRef&&this.videoPlayerRef.video,{levels:a}=this.hls,i="number"==typeof e.level?a[e.level]:{},n=this.fragStartupTime[e.url],s=-1;n&&n.startLoadTime&&n.endLoadTime&&(s=n.endLoadTime-n.startLoadTime),this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/1e3;let o={indicatedKbps:i.bitrate/1e3,duration:e.duration,level:e.level,lastStartPlayTime:null,numServerAddressChange:-1,observedKbps:this.hls.bandwidthEstimate/1e3||-1,playbackStartDate:null,serverAddress:"",sn:e.sn,sourceWidth:i.width,sourceHeight:i.height,startupTimeMs:s,switchBitrateKbps:this.lastLevelSwitchKbps||-1,uri:e.url,viewportWidth:t.clientWidth,viewportHeight:t.clientHeight,watchedDurationMs:0};r.push(o)}}}),k(this,"getCurrentVideoTime",()=>this.videoPlayerRef&&this.videoPlayerRef.video?1e3*this.videoPlayerRef.video.currentTime:null),k(this,"handleCanPlayVideo",e=>{let{contextLogData:t={},onReady:a,playing:r}=this.props,{is_closeup_video:i=!1}=t,{canPlayVideo:n}=this.state;(0,f.Hb)("handleCanPlayVideo",!0,i,{firstCanPlayEvent:!n,playing:r}),this.playbackPerformance.hasFatalError=!1,n||(this.playbackPerformance.canPlayTime=new Date),this.setState({canPlayVideo:!0}),a&&a(e)}),k(this,"handleEnded",e=>{let{loop:t,onEnded:a}=this.props,{segments:r}=this.playbackPerformance,i=r&&r[r.length-1];t&&this.videoPlayerRef&&this.videoPlayerRef.video?(this.updateWatchDurationForCurrentSegment(),i&&(i.lastStartPlayTime=0),this.fragStartupTime={}):t||this.logPlaybackPerformance(2,{initiator:"videoEnded",loop:t}),this.setState({playbackState:g.G.ENDED}),a&&a(e)}),k(this,"handleHlsError",(e,t)=>{let{contextLogData:a={}}=this.props,{is_closeup_video:r=!1}=a;if(this.playbackPerformance.detailedErrors=t.err?.message||"unknown",t.fatal){this.playbackPerformance.hasFatalError=!0,this.playbackPerformance.errorName=t.type,this.playbackPerformance.errorReason=t.details,this.playbackPerformance.errorCode=t.response&&t.response.code?t.response.code:0;let e={errorName:t.type,errorReason:t.details,errorRetryCount:this.errorRetryCount,errorMessage:t.err?.message?.slice(0,50)||"unknown",errorResponse:t.response?.text?.slice(0,50)||"unknown",playbackState:this.state.playbackState};if((0,f.Hb)("fatalError",!0,r,e),this.errorRetryCount>0)switch(this.errorRetryCount-=1,t.type){case i.Ay.ErrorTypes.NETWORK_ERROR:if(t.details===i.Ay.ErrorDetails.MANIFEST_LOAD_ERROR||t.details===i.Ay.ErrorDetails.MANIFEST_LOAD_TIMEOUT||t.details===i.Ay.ErrorDetails.MANIFEST_LOAD_PARSING_ERROR){let e=E(this.props.src);this.hls?.loadSource(e)}else this.hls?.startLoad();break;case i.Ay.ErrorTypes.MEDIA_ERROR:this.hls?.recoverMediaError()}}this.updateWatchDurationForCurrentSegment(),this.setState({playbackState:g.G.FAILED})}),k(this,"handleHlsFragBuffered",(e,t)=>{this.firstFragBuffered||(this.initializeSegments(t.frag),this.firstFragBuffered=!0)}),k(this,"handleHlsFragChanged",(e,t)=>{this.addSegment(t.frag)}),k(this,"handleHlsFragLoading",(e,t)=>{let a=t.frag?.url;a&&!this.fragStartupTime[a]&&(this.fragStartupTime[a]={startLoadTime:new Date})}),k(this,"handleHlsFragLoaded",(e,t)=>{t.frag&&t.frag.loaded&&(this.playbackPerformance.downloadedKiloBytes+=t.frag.loaded/1e3);let a=t.frag?.url;a&&this.fragStartupTime[a]&&this.fragStartupTime[a].startLoadTime&&(this.fragStartupTime[a].endLoadTime=new Date)}),k(this,"handleHlsLevelSwitched",()=>{this.hls&&this.hls.bandwidthEstimate&&(this.lastLevelSwitchKbps=this.hls.bandwidthEstimate/1e3)}),k(this,"handleLoadedMetadata",()=>{this.setState({playbackState:g.G.LOADED_METADATA})}),k(this,"handleLoadStart",()=>{this.playbackPerformance.loadStartTime=new Date,this.setState({playbackState:g.G.LOAD_START})}),k(this,"handleLoadedData",()=>{this.setState({playbackState:g.G.LOADED_DATA})}),k(this,"handlePlaying",e=>{this.playbackPerformance.hasFatalError=!1,this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.updateStallDuration(),this.updatePauseDuration(),this.setState({playbackState:g.G.PLAYING}),this.props.clearSeekTime&&this.props.clearSeekTime(),this.props.onPlaying&&this.props.onPlaying(e)}),k(this,"handleUserPause",e=>{let{onControlsPause:t}=this.props;this.lastPauseTime=new Date,t&&t(e)}),k(this,"handleVideoPause",()=>{this.state.playbackState!==g.G.STALLING&&this.state.playbackState!==g.G.SEEKING&&(this.updateWatchDurationForCurrentSegment(),this.lastPauseTime||this.updateStallDuration()),this.setState({playbackState:g.G.PAUSED})}),k(this,"handleSeeking",()=>{this.playbackPerformance.numberOfSeeks+=1;let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&(t.lastStartPlayTime=null),this.state.playbackState!==g.G.ENDED&&this.setState({playbackState:g.G.SEEKING})}),k(this,"handleStalled",()=>{null===this.lastStallTime&&this.state.playbackState!==g.G.ENDED&&(this.lastStallTime=new Date,this.playbackPerformance.numberOfStalls+=1),this.setState({playbackState:g.G.STALLING})}),k(this,"handleTimeUpdate",e=>{let{onTimeChange:t}=this.props;t&&t(e),this.state.playbackState===g.G.PLAYING&&(this.updateWatchDurationForCurrentSegment(),this.setLastSegmentStartPlayTime())}),k(this,"resetPlaybackMetrics",()=>{this.hasPlaybackStarted=!1,this.hasVideoSessionStarted=!1,this.hasVideoSessionEnded=!0,this.lastLevelSwitchKbps=null,this.lastStallTime=null,this.lastPauseTime=null,this.videoSessionId="",this.videoVisibleTime=null,this.logSessionStartOnNextPlay=!1;let e={...this.playbackPerformance.segments[this.playbackPerformance.segments.length-1],lastStartPlayTime:null,playbackStartDate:null,switchBitrateKbps:-1,watchedDurationMs:0};this.playbackPerformance.detailedErrors="",this.playbackPerformance.downloadedKiloBytes=0,this.playbackPerformance.errorCode=0,this.playbackPerformance.errorName="",this.playbackPerformance.errorReason="",this.playbackPerformance.hasFatalError=!1,this.playbackPerformance.numberOfStalls=0,this.playbackPerformance.numberOfSeeks=0,this.playbackPerformance.playbackStartTimestamp=null,this.playbackPerformance.totalStallDurationMs=0,this.playbackPerformance.segments=[e]}),k(this,"setLastSegmentStartPlayTime",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.lastStartPlayTime&&(t.lastStartPlayTime=this.getCurrentVideoTime())}),k(this,"setLastSegmentPlaybackStartDate",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.playbackStartDate&&(t.playbackStartDate=Date.now())}),k(this,"setPlaybackStartTime",()=>{this.hasPlaybackStarted||(this.playbackPerformance.playbackStartTimestamp=Date.now(),this.hasPlaybackStarted=!0)}),k(this,"setVideoPlayerRef",e=>{let{setVideoRef:t}=this.props;if(e&&(t&&t(e),this.videoPlayerRef=e,this.videoPlayerRef.video)){let e=this.videoPlayerRef.video;e.addEventListener("loadedmetadata",this.handleLoadedMetadata),e.addEventListener("loadeddata",this.handleLoadedData),e.addEventListener("pause",this.handleVideoPause),e.readyState>=3&&(this.setState({canPlayVideo:!0}),this.playbackPerformance.canPlayTime=new Date),this.props.startupLatencyPredictive&&this.nearViewportObserver&&this.nearViewportObserver.observe(e)}}),k(this,"updateStallDuration",()=>{null!==this.lastStallTime&&(this.playbackPerformance.totalStallDurationMs+=Date.now()-this.lastStallTime.getTime(),this.lastStallTime=null)}),k(this,"updatePauseDuration",()=>{if(null!==this.lastPauseTime){let{lastPauseTime:e}=this;this.playbackPerformance.totalPauseDurationMs+=Date.now()-e.getTime(),this.lastPauseTime=null}}),k(this,"updateWatchDurationForCurrentSegment",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1],a=t?t.lastStartPlayTime:null,r=this.getCurrentVideoTime();if(t&&null!==a&&"number"==typeof r&&"number"==typeof a){let e=r-a;e>0&&(t.watchedDurationMs+=e,t.lastStartPlayTime=null)}}),k(this,"logPlaybackPerformance",(e,t)=>{let{contextLogData:a={},userId:r,isAutoPlay:i,logContextEvent:n,preload:s,userAgent:o,webBrowser:l,webBrowserVersion:d}=this.props,{is_closeup_video:u=!1}=a,{canPlayTime:c,detailedErrors:h,downloadedKiloBytes:y,errorCode:g,errorName:S,errorReason:b,hasFatalError:v,playbackStartTimestamp:P,totalPauseDurationMs:k,totalStallDurationMs:E,segments:T,srcString:_,loadStartTime:w,numberOfStalls:A,numberOfSeeks:D}=this.playbackPerformance,C=this.videoPlayerRef&&this.videoPlayerRef.video,R=1===e,L=R&&!this.hasVideoSessionStarted,x=!R&&!this.hasVideoSessionEnded&&this.hasVideoSessionStarted;if(this.hls&&C&&(L||x)){let L=-1;c&&w&&(L=c>w?c.getTime()-w.getTime():0);let x=-1;c&&this.videoVisibleTime&&(x=c>this.videoVisibleTime?c.getTime()-this.videoVisibleTime.getTime():0),R&&(this.videoSessionId=(0,m.A)(r),this.playerId=this.playerId||(0,p.A)());let I={autoplaying:i,averageVideoKbps:-1,detailedErrors:h,downloadedKiloBytes:y,isCellular:!1,errorCode:g,errorName:S,errorReason:b,fatalError:v,nativeVideoDurationMs:1e3*C.duration||-1,numberOfStalls:A,numberOfSeeks:D,overallPausedDurationMs:k,overallBufferDurationMs:E,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:this.videoSessionId,playbackStartTimestamp:P||-1,segments:[],sessionMark:e,screenPixelScale:window?.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:C.clientWidth,startupPlayerHeight:C.clientHeight,startupTimeMs:L,startupLatencyMs:x,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:C.videoWidth,startupVariantHeight:C.videoHeight,videoUrl:_,wasVideoPreloaded:"auto"===s};if(!R&&T.length){let{levels:e}=this.hls,t=T[0];this.updateWatchDurationForCurrentSegment(),this.updateStallDuration();let a=T.reduce((t,a)=>a&&"number"==typeof a.level&&e&&e.length>0?t+(e[a.level]||{}).bitrate*(a.watchedDurationMs||0)/1e3:t,0),r=T.reduce((e,t)=>e+(t.watchedDurationMs||0),0),i=null,n=0,s=0;do n+=T[s].watchedDurationMs,i=i||T[s].level,s+=1;while(s<T.length&&T[s].level===i)I.startupVariantKbps=t.indicatedKbps,I.startupVariantWatchedDurationMs=n,I.startupVariantWidth=t.sourceWidth,I.startupVariantHeight=t.sourceHeight,I.startupPlayerWidth=t.viewportWidth,I.startupPlayerHeight=t.viewportHeight,I.overallWatchedDurationMs=r,r>0?(I.averageVideoKbps=a/(r/1e3),I.rebufferRate=this.playbackPerformance.totalStallDurationMs/r):0===r&&(I.averageVideoKbps=-1,I.rebufferRate=-1,I.errorName="invalid_watch_duration"),I.segments=T}else I.errorName="invalid_watch_duration";(0,f.Ay)(I,!0,u,{playbackState:this.state.playbackState,videoOptimizationExperiment:this.props.startupLatencyConfigEnabled||this.props.startupLatencyPredictive,...t});let{clientTrackingParams:V,component:O,durationNs:M,element:F,objectId:H,pairId:N,viewData:B,view:W,viewParameter:j,...U}=a;n({aux_data:{...U,is_closeup_video:u,playback_session_id:this.videoSessionId,user_agent:o,web_browser:l,web_browser_version:d},clientTrackingParams:V,component:O,duration_ns:M,element:F,event_data:{videoPerformanceData:I},event_type:3606,object_id_str:H,pair_id:N,view_data:B,view_parameter:j,view_type:W}),R?(this.hasVideoSessionStarted=!0,this.hasVideoSessionEnded=!1):this.resetPlaybackMetrics(),(0,f.Hb)(R?"sessionStart":"sessionEnd",!0,u,{playbackState:this.state.playbackState,...t})}})}componentDidMount(){let{contextLogData:e={},playing:t,startupLatencyPredictive:a}=this.props,{is_closeup_video:r=!1}=e;this.playbackPerformance.videoCreatedTime=new Date,this.initializeHls(),(0,f.Hb)("videoMounted",!0,r),t&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(1,{initiator:"mount"})),a&&this.setupNearViewportObserver()}componentDidUpdate(e){var t;let{loop:a,playing:r,src:i,visible:n,appInFocus:s,seekTime:o,captionsEnabled:l}=this.props,d=this.videoPlayerRef?.video?.textTracks[0];d&&(l?d.mode="showing":d.mode="disabled",d.addEventListener("cuechange",()=>{let e=d.activeCues&&d.activeCues.length>0&&d.activeCues[0];e&&e.line&&(e.line=-6,e.size=88)})),o&&o!==e.seekTime&&this.setState({videoStartTime:o}),e.src&&i&&(typeof(t=e.src)!=typeof i||(Array.isArray(i)?t.length!==i.length||i.some((e,a)=>!Array.isArray(t)||e.type!==t[a].type||e.src!==t[a].src):i!==t))&&this.initializeHls(),e.appInFocus&&!s&&(this.logPlaybackPerformance(2,{initiator:"update",loop:a}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===n&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(2,{initiator:"update",loop:a})),!1===e.visible&&!0===n&&(this.videoVisibleTime=this.videoVisibleTime||new Date,r?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(1,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),r&&s&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(1,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)}componentWillUnmount(){let{loop:e}=this.props;this.updatePauseDuration(),this.logPlaybackPerformance(2,{initiator:"unmount",loop:e}),this.destroyHls()}render(){let e,t,{isMainCloseupIdeaVideo:a,aspectRatio:r,backgroundColor:i,captions:s,closeupWithinMasonryEnabled:o,controls:l,inBlendedUIExp:u,loop:c,loopOverride:h,maxHeight:p,maxWidth:m,fiftyPercentHeight:f,objectFit:y,onDurationChange:g,onFullscreenChange:S,onLoadedChange:b,onControlsPlay:k,onPlayheadDown:T,onPlayheadUp:_,onSeek:w,onVolumeChange:A,peekCloseupEnabled:D,playbackRate:C,playing:R,playsInline:L=!0,poster:x,preload:I,src:V,styleOverrides:O,viewportSize:M,volume:F,variant:H}=this.props,{canPlayVideo:N,isManifestParsed:B,videoStartTime:W}=this.state,j=E(V),U=o||u,G=U?p:void 0;D&&(G="sm"===M?f:p),"media-viewer"===H&&(G="inherit");let $=u&&a?`
        [data-blended-ui-video="true"] > div {
          padding-bottom: 0 !important;
          height: 100% !important;
        }
      `:"";return(0,P.jsxs)(n.az,{alignItems:U?"center":void 0,"data-blended-ui-video":u&&a?"true":void 0,"data-video-signature":V?(t=(e=j.split("/"))[e.length-1],(t?.split(".")[0]||void 0)??void 0):void 0,display:U?"flex":void 0,height:U?"inherit":void 0,maxHeight:G,maxWidth:m,children:[(0,P.jsx)(d.A,{unsafeCSS:v.J+O+$}),(0,P.jsx)(n.Ce,{ref:this.setVideoPlayerRef,aspectRatio:r,backgroundColor:i,captions:s,controls:l,dataTestId:"duplo-hls-video",loop:void 0===h?c:h,objectFit:y,onControlsPause:this.handleUserPause,onControlsPlay:k,onDurationChange:g,onEnded:this.handleEnded,onFullscreenChange:S,onLoadedChange:b,onLoadStart:this.handleLoadStart,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:T,onPlayheadUp:_,onPlaying:this.handlePlaying,onReady:this.handleCanPlayVideo,onSeek:w,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:A,onWaiting:this.handleStalled,playbackRate:C,playing:B&&N&&R,playsInline:L,poster:x,preload:I,src:j,startTime:W,volume:F})]})}}let _=(0,r.memo)(function(e){let{country:t,isAuthenticated:a,isBot:r,isSocialBot:i,unauthId:n,userAgent:d}=(0,c._8)(),p=(0,o.A)(),m=(0,l.A)(),{closeupWithinMasonryEnabled:y,peekCloseupEnabled:g,showProductDetailPage:v,viewportSize:k}=(0,b._G)(),E=(0,s.A)({showProductDetailPage:v}),{browserName:_,browserVersion:w,isMobile:A,raw:D}=d,{contextLogData:C={}}=e,{is_closeup_video:R=!1,view:L,viewParameter:x}=C,{checkExperiment:I}=(0,u.A)(),{appUI:V}=(0,S.Y)(),O=I("web_video_fail_to_start_fix").anyEnabled?V.appInFocus:e.appInFocus,M=(0,h.A)("hlsconfig_only"),F=(0,h.A)("predictive_loading");return(0,f.Ne)({browserName:_,browserVersion:w,country:t,isAuthenticated:a,isBot:r,is_closeup_video:R,isMobile:A,isSocialBot:i,view:L,viewParameter:x}),(0,P.jsx)(T,{...e,appInFocus:O,checkExperiment:I,closeupWithinMasonryEnabled:y,inBlendedUIExp:E,isMobile:A,logContextEvent:p,peekCloseupEnabled:g,startupLatencyConfigEnabled:M,startupLatencyPredictive:F,userAgent:D,userId:m.isAuth&&m.id||n,variant:e.variant,viewportSize:k,webBrowser:_,webBrowserVersion:w})})},855149(e,t,a){a.d(t,{e:()=>u,y:()=>d});var r=a(859471),i=a(129625),n=a(767216),s=a(528989),o=a(562615);let{Provider:l,get:d}=(0,n.A)("VideoPlayer");function u({children:e}){let{logContextEvent:t,logImpression:a}=(0,i.o)(),{checkExperiment:n}=(0,s.A)(),[d,u]=(0,r.useState)(!1),[c,h]=(0,r.useState)([]),[p,m]=(0,r.useState)([]),[f,y]=(0,r.useState)({}),g=n("web_ads_mrc_video_impression").anyEnabled,S=e=>{y(t=>({...t,[e]:!0}))},b=(0,r.useCallback)(e=>{if(18===e.event_type&&e.event_data?.pinImpressions?.length){let{isNativeVideoAndWatchable:t}=e.event_data.pinImpressions[0],a=JSON.stringify(e.aux_data?.commerce_data||"").includes("story_pin_id");g&&(t||a)&&h(t=>[...t,e].slice(-1e3))}},[g]),v=(0,r.useCallback)(e=>{18===e.eventType&&g&&m(t=>[...t,e].slice(-1e3))},[g]);(0,r.useEffect)(()=>{let e=c.filter(e=>{let{pinIdStr:a}=e.event_data.pinImpressions[0];return!f[a]||!g||(t((e=>{let{time:t}=e.event_data.pinImpressions[0];return{...e,event_data:{...e.event_data,pinImpressions:[{...e.event_data.pinImpressions[0],isMrcBtr:!0,endTime:t,renderDuration:0}]}}})(e)),!1)});e.length!==c.length&&h(e)},[c,g,t,f]),(0,r.useEffect)(()=>{let e=p.filter(e=>{let t=e.eventData?.pinIdStr;if(!t)return!1;if(f[t]&&g){let t=(e=>{if(e.eventData){let{time:t}=e.eventData;return{...e,eventData:{...e.eventData,isMrcBtr:!0,endTime:t??0}}}return null})(e);return t&&a(t),!1}return!0});e.length!==p.length&&m(e)},[p,g,a,f]);let P=(0,r.useMemo)(()=>({captionsEnabled:d,logMrcVideoAdImpressionOnPlay:v,logMrcVideoAdEventOnPlay:b,setCaptionsEnabled:u,setVideoPlayed:S,videosPlayed:f}),[d,b,v,f]);return(0,o.jsx)(l,{value:P,children:e})}},135323(e,t,a){a.d(t,{A:()=>i});var r=a(528989);function i(e){let{checkExperiment:t}=(0,r.A)(),{group:a}=t("web_video_startup_latency_optimization");if("employees"===a)return!0;switch(e){case"hlsconfig_only":return"hlsconfig_only"===a||"enabled"===a;case"predictive_loading":return"predictive_loading"===a||"enabled"===a;case"enabled":return"enabled"===a;default:return!1}}},431803(e,t,a){a.d(t,{A:()=>i});var r=a(679902);function i(){return(0,r.A)()}},989715(e,t,a){a.d(t,{A:()=>i});var r=a(679902);function i(e){return e+"-"+(0,r.A)()}},143630(e,t,a){a.d(t,{Ay:()=>u,Hb:()=>d,Ne:()=>l});var r=a(148322);a(661373);var i=a(892804);let n=["isCellular","videoUrl","sessionMark"],s={},o="",l=e=>{let{browserName:t,browserVersion:a,country:i,isAuthenticated:n,isBot:l,isMobile:d,isSocialBot:u,view:c="unknown",viewParameter:h="unknown"}=e;o=u&&"socialBot"||l&&"bot"||"nonbot";let p=(0,r.A)(i);s={browserName:t,browserVersion:a?.split(".")[0]||"0",isAuthenticated:n,isMobile:d,region:p,view:c,viewParameter:h}};function d(e,t,a,r={}){let n={...r,...s},l=`web.video.${t?"hls":"nonHls"}.${o}.${a?"closeup":"nonCloseup"}.${e}`;"nonbot"===o&&(0,i.GV)(l,{sampleRate:1,tags:n})}function u(e,t,a,r={}){let l=a?"closeup":"nonCloseup",d=t?"hls":"nonHls",c=1===e.sessionMark?"sessionStart":"sessionEnd",h={...r,...s};if("nonbot"===o&&(Object.entries(e).forEach(([t,a])=>{let r=`web.video.${d}.${o}.${l}.${c}.${t}`,s=parseInt(a,10),u="number"==typeof s?s:-1;if(!n.includes(t))if(t.includes("fatalError")&&!0===a){let{errorCode:t,errorName:a,errorReason:n}=e;(0,i.GV)(r,{sampleRate:1,tags:{errorCode:t,errorName:a,errorReason:n,...h}})}else if(t.includes("Width")||t.includes("Height")){let e=u<0?"negative":0===u?"zero":u<200?"xs":u<400?"s":u<600?"m":u<800?"l":u<1e3?"xl":u<1200?"xxl":"over1200";(0,i.GV)(r,{sampleRate:1,tags:{dimensionBucket:e,...h}})}else if("numberOfStalls"===t){let e=a;u>1e3?e="over1000":u>10?e="over10":u<0&&(e="negative"),(0,i.GV)(r,{sampleRate:1,tags:{numberOfStalls:e,...h}})}else"screenPixelScale"===t?(0,i.GV)(r,{sampleRate:1,tags:{screenPixelScale:a||-1,...h}}):u>=0?(0===u&&(0,i.GV)(`${r}.zero`,{sampleRate:1,tags:h}),(0,i.N9)(r,u,{sampleRate:1})):u<0&&(0,i.GV)(`${r}.negative`,{sampleRate:1,tags:h})}),1!==e.sessionMark)){let{rebufferRate:t,screenPixelScale:a,startupLatencyMs:r,startupVariantWidth:n,startupPlayerWidth:s}=e,u=`web.video.${d}.${o}.${l}.${c}`;"number"==typeof n&&"number"==typeof s&&"number"==typeof a&&(0,i.GV)(`${u}.upscaled.${1.5*n>a*s?"good":"bad"}`,{sampleRate:1,tags:h}),"number"==typeof r&&(0,i.GV)(`${u}.startupLatency.${r<500?"good":"bad"}`,{sampleRate:1,tags:h}),"number"==typeof t&&(0,i.GV)(`${u}.rebufferRate.${t<.01?"good":"bad"}`,{sampleRate:1,tags:h})}}},434318(e,t,a){function r(e,t){return e?t?{hlsConfig:{autoStartLoad:!0,startFragPrefetch:!0,startPosition:-1,startLevel:0,maxBufferLength:4,backBufferLength:15,maxMaxBufferLength:30,lowBufferWatchdogPeriod:1,highBufferWatchdogPeriod:2,maxStarvationDelay:2,maxLoadingDelay:4,nudgeMaxRetry:3,capLevelToPlayerSize:!0,abrEwmaFastLive:3,abrEwmaSlowLive:12,abrEwmaDefaultEstimate:4e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxFragLookUpTolerance:.25,maxBufferHole:.5,enableWorker:!0,fragLoadingMaxRetry:3,fragLoadingMaxRetryTimeout:64e3,levelLoadingMaxRetry:4,manifestLoadingMaxRetry:3},preloadForAutoplay:"metadata"}:{hlsConfig:{autoStartLoad:!0,startFragPrefetch:!0,startPosition:-1,startLevel:1,maxBufferLength:8,backBufferLength:20,maxMaxBufferLength:60,lowBufferWatchdogPeriod:1,highBufferWatchdogPeriod:2,maxStarvationDelay:2,maxLoadingDelay:4,nudgeMaxRetry:3,capLevelToPlayerSize:!0,abrEwmaFastLive:3,abrEwmaSlowLive:15,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,maxFragLookUpTolerance:.25,maxBufferHole:.5,enableWorker:!0,fragLoadingMaxRetry:3,fragLoadingMaxRetryTimeout:64e3,levelLoadingMaxRetry:4,manifestLoadingMaxRetry:3},preloadForAutoplay:"auto"}:{hlsConfig:{startLevel:2},preloadForAutoplay:"metadata"}}a.d(t,{A:()=>r})},661373(e,t,a){a.d(t,{G:()=>r,o:()=>i});let r=Object.freeze({DEFAULT:0,LOAD_START:1,LOADED_METADATA:2,LOADED_DATA:3,PLAYING:4,PAUSED:5,SEEKING:6,STALLING:7,FAILED:8,ENDED:9}),i=Object.freeze({MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4})},208762(e,t,a){a.d(t,{_G:()=>u,oh:()=>d});var r=a(335831),i=a(859471),n=a(353461),s=a(562615);let o={showCloseupContentRight:!0,showProductDetailPage:!1,viewportSize:"lg",paneWidth:n.qr,maxWidth:n.QH,descriptionPaneWidth:n.QH-n.qr,isCommentAttachmentSelectorOpen:!1,isCommentComposerFocused:!1,isCommentPopoverInteractionActive:!1,isCommentThreadExpanded:!1,isCloseupMediaViewerOpen:!1,isMediaViewerOpen:!1,isShoppingModuleExpanded:!1,closeupWithinMasonryEnabled:!1,peekCloseupEnabled:!1,calculatedImageHeight:0,setAbortNoActionPlacementTimeout:()=>{},setIsCloseupMediaViewerOpen:()=>{},setIsCommentAttachmentSelectorOpen:()=>{},setIsCommentComposerFocused:()=>{},setIsCommentPopoverInteractionActive:()=>{},setIsMediaViewerOpen:()=>{},setIsShoppingModuleExpanded:()=>{},setCalculatedImageHeight:()=>{},setViewportSize:()=>{}},l=(0,i.createContext)(o);function d({children:e,value:t}){(0,i.useEffect)(()=>{(0,r.A)("Context","/app/www/closeup/desktop/Context.tsx")},[]);let a=(0,i.useMemo)(()=>({...o,...t}),[t]);return(0,s.jsx)(l,{value:a,children:e})}function u(){let e=(0,i.use)(l);if(!e)throw Error("useCloseupContext must be used within CloseupContextProvider");return e}},353461(e,t,a){a.d(t,{DG:()=>o,Em:()=>S,En:()=>v,Ii:()=>k,M1:()=>h,MI:()=>g,QH:()=>n,Ye:()=>u,Z:()=>p,bZ:()=>m,bo:()=>s,gr:()=>P,h3:()=>d,n0:()=>c,nb:()=>f,qr:()=>i,t4:()=>E,tb:()=>l,vg:()=>y,w$:()=>b});var r=a(836737);let i=508,n=1016,s=488,o=992,l=672,d=1176,u=40,c=72,h=740,p=32,m=16,f=24,y=2,g=1,S=new r.rk(5),b={ARTICLE:"https://schema.org/Article",BRAND:"https://schema.org/Brand",PRODUCT:"https://schema.org/Product",RECIPE:"https://schema.org/Recipe",OFFER:"https://schema.org/Offer",OUT_OF_STOCK:"https://schema.org/OutOfStock",PERSON:"https://schema.org/Person"},v={boxShadow:"0 2px 5px rgba(0, 0, 0, 0.06)",transition:"box-shadow 200ms ease-in-out"},P="calc(90vh - 80px)",k="calc(55vh + 80px)",E="calc(75vh - 80px)"},922834(e,t,a){a.d(t,{y:()=>r});let r=new(a(836737)).rk(700)},456030(e,t,a){a.d(t,{A:()=>v,J:()=>S});var r=a(335831),i=a(859471),n=a(512850),s=a(836737),o=a(626847),l=a(396901),d=a(538346),u=a(376195),c=a(491149),h=a(855149),p=a(47998),m=a(257470),f=a(892804),y=a(562615);function g(e,t,a){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let S=`
  video::cue {
    color: white;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', Ubuntu, Cantarell, 'Fira Sans', 'Droid Sans', 'Helvetica Neue', Helvetica, 'ãã©ã®ãè§ã´ Pro W3', 'ã¡ã¤ãªãª', Meiryo, 'ï¼­ï¼³ ï¼°ã´ã·ãã¯', Arial, sans-serif;
    font-weight: 450;
    font-size: 18px;
  }
`;class b extends i.PureComponent{constructor(...e){super(...e),g(this,"state",{videoStartTime:this.props.initialVideoStartTime,started:!1}),g(this,"setVideoPlayerRef",e=>{let{setVideoRef:t,handlePlay:a,autoplay:r=!0,isBrowserSafari:i}=this.props;this.videoPlayerRef=e,e&&t&&t(e.video),e&&i&&this.pendingSafariSrc&&this.setSafariVideoSource(this.pendingSafariSrc),this.videoPlayerRef&&this.videoPlayerRef.video&&a&&r&&this.videoPlayerRef.video.addEventListener("canplay",async()=>{if(i)try{await this.videoPlayerRef?.video?.play(),a&&a({userTriggeredPlay:!1})}catch{(0,f.GV)("mweb.closeup.hls_video.safari.autoplay_prevented")}else a({userTriggeredPlay:!1})})}),g(this,"hls",null),g(this,"pendingSafariSrc",null),g(this,"initializeHls",()=>{this.destroyHls();let{src:e,isBrowserSafari:t}=this.props;if(n.Ay.isSupported()&&!t){let t=new n.Ay;t.loadSource(e),this.videoPlayerRef&&t.attachMedia(this.videoPlayerRef.video),this.hls=t}else t&&(this.hls=null,this.videoPlayerRef?.video?this.setSafariVideoSource(e):this.pendingSafariSrc=e)}),g(this,"destroyHls",()=>{let{hls:e}=this,{isBrowserSafari:t}=this.props;e&&(t||e.destroy(),this.hls=null),this.pendingSafariSrc=null}),g(this,"onPlay",({event:e})=>{let{handlePlay:t}=this.props;e.stopPropagation(),t&&t({userTriggeredPlay:!0})}),g(this,"onPause",({event:e})=>{let{handlePause:t}=this.props;e.stopPropagation(),t&&t()}),g(this,"handleVolumeChange",({event:e,volume:t})=>{let{onVolumeChange:a}=this.props;e.stopPropagation(),a&&a({volume:t})}),g(this,"handleOnReady",e=>{this.props.onReady&&this.props.onReady(e)}),g(this,"handleEnded",()=>{let{onEnded:e,resetCurrentTime:t}=this.props;e&&e(),t()}),g(this,"handlePlaying",()=>{let{clearSeekTime:e,setVideoPlayed:t}=this.props;e&&e(),!this.state.started&&(this.setState({started:!0}),t&&t())}),g(this,"setSafariVideoSource",e=>{if(!this.videoPlayerRef?.video)return;let{video:t}=this.videoPlayerRef;t.src=e,t.load(),this.pendingSafariSrc=null})}componentDidMount(){this.initializeHls()}componentWillUnmount(){this.destroyHls()}componentDidUpdate(e){let{playing:t,src:a,seekTime:r,captionsEnabled:i,isBrowserSafari:s,isDesktop:o,isTablet:l,requestContext:d,isVideoPin:u}=this.props,{isAuthenticated:c}=d;r&&r!==e.seekTime&&this.setState({videoStartTime:r});let h=this.videoPlayerRef?.video?.textTracks[0];if(h&&(i?h.mode="showing":h.mode="disabled",h.addEventListener("cuechange",()=>{let e=h.activeCues&&h.activeCues.length>0&&h.activeCues[0];if(e&&e.line&&e.size)if(o)e.line=-6,e.size=88;else{if(e.size=70,u){e.line=-5;return}c?e.line=-8:(e.line=-10,l&&(e.line=-15))}})),e.src!==a){if(this.initializeHls(),this.hls&&n.Ay.isSupported()&&!s)this.hls.on(n.Ay.Events.MANIFEST_PARSED,()=>{void 0!==t&&t&&this.videoPlayerRef&&this.videoPlayerRef.play()});else if(s&&this.videoPlayerRef?.video){let e=()=>{void 0!==t&&t&&this.videoPlayerRef&&this.videoPlayerRef.play(),this.videoPlayerRef?.video?.removeEventListener("loadedmetadata",e)};this.videoPlayerRef.video.addEventListener("loadedmetadata",e);let a=async()=>{if(void 0!==t&&t&&this.props.handlePlay)try{await this.videoPlayerRef?.video?.play(),this.props.handlePlay({userTriggeredPlay:!1})}catch{(0,f.GV)("mweb.closeup.hls_video.safari.autoplay_prevented_on_update")}this.videoPlayerRef?.video?.removeEventListener("canplay",a)};this.videoPlayerRef.video.addEventListener("canplay",a)}}}render(){let{aspectRatio:e,controls:t,loop:a=!1,poster:r,src:i,onTimeChange:n,playing:o,volume:l,captions:u}=this.props;return(0,y.jsxs)(s.az,{width:"100%",children:[(0,y.jsx)(d.A,{unsafeCSS:S}),(0,y.jsx)(s.Ce,{ref:this.setVideoPlayerRef,aspectRatio:e,autoplay:o,captions:u,controls:t,crossOrigin:"anonymous",dataTestId:"duplo-hls-video",loop:a,onControlsPause:this.onPause,onControlsPlay:this.onPlay,onEnded:this.handleEnded,onPlay:()=>{},onPlayError:()=>{},onPlaying:this.handlePlaying,onReady:this.handleOnReady,onTimeChange:n,onVolumeChange:this.handleVolumeChange,playing:o,playsInline:!0,poster:r,src:i,startTime:this.state.videoStartTime||void 0,volume:l})]})}}function v(e){(0,i.useEffect)(()=>{(0,r.A)("HlsVideo","/app/www/storyPins/duplo/HlsVideo.tsx")},[]);let{clearSeekTime:t,pinId:a="",seekTime:n}=e,{setVideoPlayed:s}=(0,h.y)(),d=(0,l.A)(),f=(0,u._8)(),g=(0,c.qJ)(),S=(0,c.wI)(),{initialVideoStartTime:v,resetCurrentTime:P}=function(e){let{isAuth:t}=(0,p.A)(),a=(0,c.qJ)(),{appUI:r,setCurrentVideo:i}=(0,m.Y)(),n=!t&&a,s=0;if(n){let{videosAutoplaying:t}=r,{organicVideosAutoplaying:a}=t,i=a[e];s=i?.currentTime||0}return{initialVideoStartTime:s,resetCurrentTime:()=>{n&&i({pinId:e,currentTime:0,isPromoted:!1})}}}(a),k=(0,o.nr)(f?.userAgent?.browserName);return(0,y.jsx)(b,{...e,clearSeekTime:()=>{t&&t(a)},i18n:d,initialVideoStartTime:v,isBrowserSafari:k,isDesktop:g,isTablet:S,requestContext:f,resetCurrentTime:P,seekTime:n,setVideoPlayed:()=>{a&&s(a)}})}},712459(e,t,a){a.r(t),a.d(t,{testExports:()=>M,VideoWrapper:()=>F,default:()=>H});var r,i=a(335831),n=a(859471);a(224989);var s=a(578576),o=a(363906),l=a(900565),d=a(376195),u=a(661399),c=a(892098),h=a(135323),p=a(434318),m=a(855149),f=a(257470),y=a(208762),g=a(836737),S=a(296377),b=a(626847),v=a(129625),P=a(47998),k=a(538346),E=a(431803),T=a(989715),_=a(143630),w=a(661373),A=a(456030),D=a(562615);function C(e,t,a){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function R(e){return e&&void 0!==e?"string"==typeof e?e:Array.isArray(e)&&e[0].src?e[0].src:`unsupported_type_${typeof e}`:"undefined"}class L extends n.Component{constructor(...e){super(...e),C(this,"state",{canPlayVideo:!1,playbackState:w.G.DEFAULT,videoStartTime:this.props.seekTime?this.props.seekTime:this.props.videoStartTime||0}),C(this,"errorRetryCount",2),C(this,"hasSegmentStarted",!1),C(this,"hasPlaybackStarted",!1),C(this,"hasVideoSessionStarted",!1),C(this,"hasVideoSessionEnded",!1),C(this,"lastStallTime",null),C(this,"lastPauseTime",null),C(this,"logSessionStartOnNextPlay",!1),C(this,"playerId",""),C(this,"videoSessionId",""),C(this,"videoVisibleTime",void 0),C(this,"playbackPerformance",{canPlayTime:null,detailedErrors:"",errorCode:0,errorName:"",errorReason:"",hasFatalError:!1,loadStartTime:null,numberOfStalls:0,numberOfSeeks:0,playbackStartTimestamp:null,segments:[],srcString:this.props.src?R(this.props.src):void 0,totalStallDurationMs:0,totalPauseDurationMs:0,userAgent:this.props.userAgent,webBrowser:this.props.webBrowser,webBrowserVersion:this.props.webBrowserVersion}),C(this,"componentDidMount",()=>{let{contextLogData:e={},playing:t}=this.props,{is_closeup_video:a=!1}=e;(0,_.Hb)("videoMounted",!1,a),t&&(this.videoVisibleTime=new Date,this.logPlaybackPerformance(1,{initiator:"mount"}));let r=this.videoPlayerRef?.video?.textTracks[0];r&&r.addEventListener("cuechange",()=>{let e=r.activeCues&&r.activeCues.length>0&&r.activeCues[0];e&&e.line&&(e.line=-6,e.size=88)})}),C(this,"componentDidUpdate",e=>{let{playing:t,visible:a,appInFocus:r,seekTime:i,captionsEnabled:n}=this.props;i&&i!==e.seekTime&&this.setState({videoStartTime:i});let s=this.videoPlayerRef?.video?.textTracks[0];s&&(n?s.mode="showing":s.mode="disabled"),e.appInFocus&&!r&&(this.logPlaybackPerformance(2,{initiator:"update"}),this.logSessionStartOnNextPlay=!0),e.visible&&!1===a&&(this.logSessionStartOnNextPlay=!1,this.updatePauseDuration(),this.logPlaybackPerformance(2,{initiator:"update"})),!1===e.visible&&!0===a&&(this.videoVisibleTime=this.videoVisibleTime||new Date,t?(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(1,{initiator:"update"})):this.logSessionStartOnNextPlay=!0),t&&r&&this.logSessionStartOnNextPlay&&(this.setPlaybackStartTime(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.logPlaybackPerformance(1,{initiator:"update"}),this.logSessionStartOnNextPlay=!1)}),C(this,"addSegment",()=>{let{canPlayTime:e,loadStartTime:t,segments:a,srcString:r}=this.playbackPerformance,i=-1;e&&t&&0===a.length&&(i=e>t?e.getTime()-t.getTime():0);let n=this.videoPlayerRef&&this.videoPlayerRef.video,s={indicatedKbps:-1,duration:n&&1e3*n.duration||-1,lastStartPlayTime:null,level:-1,numServerAddressChange:-1,observedKbps:-1,playbackStartDate:null,serverAddress:"",sourceWidth:-1,sourceHeight:-1,startupTimeMs:i,switchBitrateKbps:-1,uri:r,viewportWidth:n&&n.clientWidth||-1,viewportHeight:n&&n.clientHeight||-1,watchedDurationMs:0};a.push(s)}),C(this,"getCurrentVideoTime",()=>this.videoPlayerRef&&this.videoPlayerRef.video?1e3*this.videoPlayerRef.video.currentTime:0),C(this,"getVideoResourceTiming",()=>{if(window?.performance?.getEntriesByName&&this.playbackPerformance.srcString){let e=window.performance.getEntriesByName(this.playbackPerformance.srcString);return e.length>0&&e[0]||null}return null}),C(this,"handleCanPlayVideo",e=>{let{contextLogData:t={},onReady:a,playing:r}=this.props,{is_closeup_video:i=!1}=t,{canPlayVideo:n}=this.state;(0,_.Hb)("handleCanPlayVideo",!1,i,{firstCanPlayEvent:!n,playing:r}),this.playbackPerformance.hasFatalError=!1,n||(this.playbackPerformance.canPlayTime=new Date),this.setState({canPlayVideo:!0}),a&&a(e)}),C(this,"handleEnded",e=>{let{loop:t,onEnded:a}=this.props,{segments:r}=this.playbackPerformance,i=r&&r[r.length-1];t&&this.videoPlayerRef&&this.videoPlayerRef.video?(this.updateWatchDurationForCurrentSegment(),i&&(i.lastStartPlayTime=0),this.hasSegmentStarted=!1):t||this.logPlaybackPerformance(2,{initiator:"videoEnded",loop:t}),this.setState({playbackState:w.G.ENDED}),a&&a(e)}),C(this,"handleError",()=>{let{contextLogData:e={}}=this.props,{is_closeup_video:t=!1}=e,a=this.videoPlayerRef&&this.videoPlayerRef.video;a?.error?.code!==w.o.MEDIA_ERR_ABORTED&&(this.playbackPerformance.hasFatalError=!0),this.playbackPerformance.detailedErrors+=`${this.playbackPerformance.detailedErrors.length>0?", ":""}${a?.error?.message||""}`,this.playbackPerformance.errorCode=a?.error?.code||0,this.playbackPerformance.errorName=a?.error?.message?.slice(0,100)||"unknown",this.playbackPerformance.errorReason=a?.error?.message?.slice(0,100)||"unknown";let r={errorName:this.playbackPerformance.errorCode,errorReason:this.playbackPerformance.errorName,errorRetryCount:this.errorRetryCount,playbackState:this.state.playbackState,networkState:a?.networkState||"unknown"};switch((0,_.Hb)("fatalError",!1,t,r),a?.error?.code){case w.o.MEDIA_ERR_ABORTED:break;case w.o.MEDIA_ERR_NETWORK:case w.o.MEDIA_ERR_DECODE:case w.o.MEDIA_ERR_SRC_NOT_SUPPORTED:default:this.errorRetryCount>0&&(a?.load(),this.errorRetryCount-=1)}this.updateWatchDurationForCurrentSegment(),this.setState({playbackState:w.G.FAILED})}),C(this,"handleLoadedMetadata",()=>{this.setState({playbackState:w.G.LOADED_METADATA})}),C(this,"handleLoadStart",()=>{this.playbackPerformance.loadStartTime=new Date,this.setState({playbackState:w.G.LOAD_START})}),C(this,"handleLoadedData",()=>{this.setState({playbackState:w.G.LOADED_DATA})}),C(this,"handlePlaying",e=>{this.playbackPerformance.hasFatalError=!1,this.setPlaybackStartTime(),this.hasSegmentStarted||this.addSegment(),this.setLastSegmentStartPlayTime(),this.setLastSegmentPlaybackStartDate(),this.updateStallDuration(),this.updatePauseDuration(),this.setState({playbackState:w.G.PLAYING}),this.props.clearSeekTime&&this.props.clearSeekTime(),this.props.onPlaying&&this.props.onPlaying(e)}),C(this,"handleUserPause",({event:e})=>{let{onControlsPause:t}=this.props;this.lastPauseTime=new Date,t&&t({event:e})}),C(this,"handleVideoPause",()=>{this.state.playbackState!==w.G.STALLING&&this.state.playbackState!==w.G.SEEKING&&(this.updateWatchDurationForCurrentSegment(),this.lastPauseTime||this.updateStallDuration()),this.setState({playbackState:w.G.PAUSED})}),C(this,"handleSeeking",()=>{this.playbackPerformance.numberOfSeeks+=1;let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&(t.lastStartPlayTime=null),this.state.playbackState!==w.G.ENDED&&this.setState({playbackState:w.G.SEEKING})}),C(this,"handleStalled",()=>{null===this.lastStallTime&&this.state.playbackState!==w.G.ENDED&&(this.lastStallTime=new Date,this.playbackPerformance.numberOfStalls+=1,this.setState({playbackState:w.G.STALLING}))}),C(this,"handleTimeUpdate",e=>{let{onTimeChange:t}=this.props;t&&t(e),this.state.playbackState===w.G.PLAYING&&(this.updateWatchDurationForCurrentSegment(),this.setLastSegmentStartPlayTime())}),C(this,"resetPlaybackMetrics",()=>{this.hasSegmentStarted=!0,this.hasPlaybackStarted=!1,this.hasVideoSessionStarted=!1,this.hasVideoSessionEnded=!0,this.lastStallTime=null,this.lastPauseTime=null,this.videoSessionId="",this.videoVisibleTime=null,this.logSessionStartOnNextPlay=!1;let e={...this.playbackPerformance.segments[this.playbackPerformance.segments.length-1],lastStartPlayTime:null,playbackStartDate:null,watchedDurationMs:0};this.playbackPerformance.detailedErrors="",this.playbackPerformance.errorCode=0,this.playbackPerformance.errorName="",this.playbackPerformance.errorReason="",this.playbackPerformance.hasFatalError=!1,this.playbackPerformance.numberOfStalls=0,this.playbackPerformance.numberOfSeeks=0,this.playbackPerformance.playbackStartTimestamp=null,this.playbackPerformance.totalStallDurationMs=0,this.playbackPerformance.segments=[e]}),C(this,"setLastSegmentStartPlayTime",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.lastStartPlayTime&&(t.lastStartPlayTime=this.getCurrentVideoTime())}),C(this,"setLastSegmentPlaybackStartDate",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1];t&&null===t.playbackStartDate&&(t.playbackStartDate=Date.now())}),C(this,"setPlaybackStartTime",()=>{this.hasPlaybackStarted||(this.playbackPerformance.playbackStartTimestamp=Date.now(),this.hasPlaybackStarted=!0)}),C(this,"setVideoPlayerRef",e=>{let{setVideoRef:t}=this.props;if(e&&(t&&t(e),this.videoPlayerRef=e,this.videoPlayerRef.video)){let{isSafariBrowser:e}=this.props,t=this.videoPlayerRef.video;if(t.addEventListener("loadedmetadata",this.handleLoadedMetadata),t.addEventListener("loadeddata",this.handleLoadedData),t.addEventListener("pause",this.handleVideoPause),e){let e=()=>{this.handleCanPlayVideo({event:{}})};t.addEventListener("canplay",e),t.addEventListener("loadedmetadata",e),t.addEventListener("loadeddata",e),this.state.canPlayVideo||setTimeout(()=>{t&&t.load()},100)}t.readyState>=3&&(this.setState({canPlayVideo:!0}),this.playbackPerformance.canPlayTime=new Date)}}),C(this,"updateStallDuration",()=>{if(null!==this.lastStallTime){let{lastStallTime:e}=this;this.playbackPerformance.totalStallDurationMs+=Date.now()-e.getTime(),this.lastStallTime=null}}),C(this,"updatePauseDuration",()=>{if(null!==this.lastPauseTime){let{lastPauseTime:e}=this;this.playbackPerformance.totalPauseDurationMs+=Date.now()-e.getTime(),this.lastPauseTime=null}}),C(this,"updateWatchDurationForCurrentSegment",()=>{let{segments:e}=this.playbackPerformance,t=e&&e[e.length-1],a=t?t.lastStartPlayTime:null,r=this.getCurrentVideoTime();if(t&&null!==a&&"number"==typeof r&&"number"==typeof a){let e=r-a;e>0&&(t.watchedDurationMs+=e,t.lastStartPlayTime=null)}}),C(this,"logPlaybackPerformance",(e,t)=>{let{contextLogData:a={},userId:r,isAutoPlay:i,logContextEvent:n,preload:s,userAgent:o,webBrowser:l,webBrowserVersion:d}=this.props,{is_closeup_video:u=!1}=a,{canPlayTime:c,detailedErrors:h,errorCode:p,errorName:m,errorReason:f,hasFatalError:y,loadStartTime:g,totalPauseDurationMs:S,totalStallDurationMs:b,numberOfStalls:v,numberOfSeeks:P,playbackStartTimestamp:k,segments:w,srcString:A}=this.playbackPerformance,D=this.videoPlayerRef&&this.videoPlayerRef.video,C=1===e,R=C&&!this.hasVideoSessionStarted,L=!C&&!this.hasVideoSessionEnded&&this.hasVideoSessionStarted;if(D&&(R||L)){let R=-1;c&&g&&(R=c>g?c.getTime()-g.getTime():0);let L=-1;c&&this.videoVisibleTime&&(L=c>this.videoVisibleTime?c.getTime()-this.videoVisibleTime.getTime():0),C&&(this.videoSessionId=(0,T.A)(r),this.playerId=this.playerId||(0,E.A)());let x=this.getVideoResourceTiming(),I={averageVideoKbps:-1,autoplaying:i,detailedErrors:h,downloadedKiloBytes:"number"==typeof x?.decodedBodySize&&x.decodedBodySize/1e3||0,errorCode:p,errorName:m,errorReason:f,fatalError:y,isCellular:!1,nativeVideoDurationMs:1e3*D.duration||-1,numberOfStalls:v,numberOfSeeks:P,overallPausedDurationMs:S,overallBufferDurationMs:b,overallWatchedDurationMs:-1,rebufferRate:-1,playbackSessionId:this.videoSessionId,playbackStartTimestamp:k||-1,segments:[],sessionMark:e,screenPixelScale:window?.devicePixelRatio?window.devicePixelRatio:-1,startupPlayerWidth:D.clientWidth,startupPlayerHeight:D.clientHeight,startupTimeMs:R,startupLatencyMs:L,startupVariantKbps:-1,startupVariantWatchedDurationMs:-1,startupVariantWidth:D.videoWidth,startupVariantHeight:D.videoHeight,videoUrl:A,wasVideoPreloaded:"auto"===s};if(!C){this.updateWatchDurationForCurrentSegment(),this.updateStallDuration();let e=w.reduce((e,t)=>e+(t.watchedDurationMs||0),0);I.overallWatchedDurationMs=e,I.startupVariantWatchedDurationMs=e,I.segments=this.playbackPerformance.segments,0===e?(I.errorName="invalid_watch_duration",I.rebufferRate=-1):I.rebufferRate=b/e}(0,_.Ay)(I,!1,u,{playbackState:this.state.playbackState,...t});let{view:V,viewParameter:O,component:M,element:F,objectId:H,...N}=a;n({event_type:3606,event_data:{videoPerformanceData:I},view_type:V,view_parameter:O,component:M,element:F,object_id_str:H,aux_data:{...N,is_closeup_video:u,playback_session_id:this.videoSessionId,user_agent:o,web_browser:l,web_browser_version:d}}),C?(this.hasVideoSessionStarted=!0,this.hasVideoSessionEnded=!1):this.resetPlaybackMetrics(),(0,_.Hb)(C?"sessionStart":"sessionEnd",!1,u,{playbackState:this.state.playbackState,...t})}})}componentWillUnmount(){let{loop:e}=this.props;this.updatePauseDuration(),this.logPlaybackPerformance(2,{initiator:"unmount",loop:e})}render(){let{isMainCloseupIdeaVideo:e,aspectRatio:t,backgroundColor:a,captions:r,closeupWithinMasonryEnabled:i,controls:n,fiftyPercentHeight:s,inBlendedUIExp:o,loop:l,loopOverride:d,maxHeight:u,maxWidth:c="100%",objectFit:h,onDurationChange:p,onFullscreenChange:m,onLoadedChange:f,onControlsPlay:y,onPlayheadDown:S,onPlayheadUp:b,onSeek:v,onVolumeChange:P,styleOverrides:E,peekCloseupEnabled:T,playbackRate:_,playing:w,playsInline:C=!0,poster:L,preload:x,src:I,viewportSize:V,volume:O}=this.props,{canPlayVideo:M,videoStartTime:F}=this.state,H=i||o,N=H?u:void 0;T&&(N="sm"===V?s:u);let B=o&&e?`
        [data-blended-ui-video="true"] > div {
          padding-bottom: 0 !important;
          height: 100% !important;
        }
      `:"";return(0,D.jsxs)(g.az,{alignItems:H?"center":void 0,"data-blended-ui-video":o&&e?"true":void 0,"data-video-signature":I?(e=>{let t=R(e);if(!t||"undefined"===t||t.startsWith("unsupported_type_"))return;let a=t.split("/"),r=a[a.length-1];return r?.split(".")[0]||void 0})(I):void 0,display:H?"flex":void 0,height:H?"inherit":void 0,maxHeight:N,maxWidth:c,children:[(0,D.jsx)(k.A,{unsafeCSS:A.J+E+B}),(0,D.jsx)(g.Ce,{ref:this.setVideoPlayerRef,aspectRatio:t,autoplay:M&&w,backgroundColor:a,captions:r,controls:n,loop:void 0===d?l:d,objectFit:h,onControlsPause:this.handleUserPause,onControlsPlay:y,onDurationChange:p,onEnded:this.handleEnded,onError:this.handleError,onFullscreenChange:m,onLoadedChange:f,onLoadStart:this.handleLoadStart,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:S,onPlayheadUp:b,onPlaying:this.handlePlaying,onReady:this.handleCanPlayVideo,onSeek:v,onSeeking:this.handleSeeking,onStalled:this.handleStalled,onTimeChange:this.handleTimeUpdate,onVolumeChange:P,onWaiting:this.handleStalled,playbackRate:_,playing:M&&w,playsInline:C,poster:L,preload:x,src:I?R(I):void 0,startTime:F||void 0,volume:O})]})}}let x=(0,n.memo)(function(e){let{logContextEvent:t}=(0,v.o)(),{country:a,isAuthenticated:r,isBot:i,isSocialBot:n,unauthId:s,userAgent:o}=(0,d._8)(),{browserName:l,browserVersion:c,isMobile:h,raw:p}=o,{contextLogData:m={}}=e,{is_closeup_video:g=!1,view:k,viewParameter:E}=m,{appUI:{appInFocus:T}}=(0,f.Y)(),{clearSeekTime:w}=(0,u.d1)(),{closeupWithinMasonryEnabled:A,peekCloseupEnabled:C,showProductDetailPage:R,viewportSize:x}=(0,y._G)(),I=(0,S.A)({showProductDetailPage:R}),V=(0,b.nr)(o.browserName),O=(0,P.A)();return(0,_.Ne)({browserName:l,browserVersion:c,country:a,isAuthenticated:r,isBot:i,is_closeup_video:g,isMobile:h,isSocialBot:n,view:k,viewParameter:E}),(0,D.jsx)(L,{...e,appInFocus:T,clearSeekTime:w,closeupWithinMasonryEnabled:A,inBlendedUIExp:I,isSafariBrowser:V,logContextEvent:t,peekCloseupEnabled:C,userAgent:p,userId:O.isAuth&&O.id||s,viewportSize:x,webBrowser:l,webBrowserVersion:c})});function I(e,t,a){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}let V=(void 0!==r||(r=a(699667)).hash&&"35625201030ecf10998f70bc5b4b5501"!==r.hash&&console.error("The definition of 'VideoWrapper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),O=e=>{if(Array.isArray(e)){let t=e.find(e=>"video/m3u8"===e.type);return t?t.src:void 0}return"string"==typeof e&&/m3u8$/.test(e)?e:void 0},M={getPlaylistSourceSrc:O};class F extends n.PureComponent{constructor(...e){super(...e),I(this,"componentDidUpdate",e=>{e.videoStartTime&&this.props.videoStartTime&&e.videoStartTime<this.props.videoStartTime&&this.videoPlayerRef?.video&&(this.videoPlayerRef.video.currentTime=this.props.videoStartTime)}),I(this,"isHslVideo",()=>{let e=this.props.src?O(this.props.src):void 0;return!this.props.preferMp4&&!!e}),I(this,"setVideoPlayerRef",e=>{e&&(this.videoPlayerRef=e,e&&this.props.setVideoRef&&this.props.setVideoRef(e?.video))}),I(this,"handleOnEnded",({event:e})=>{let{loop:t,onLoop:a,onEnded:r}=this.props;r&&(r({event:e}),this.videoPlayerRef&&this.videoPlayerRef.video&&t&&(this.videoPlayerRef.video.play(),a&&a()))}),I(this,"handlePlaying",e=>{this.props.onPlaying&&this.props.onPlaying(e)})}render(){let{isMainCloseupIdeaVideo:e,aspectRatio:t,appInFocus:a,backgroundColor:r,captions:i,toggleCaptions:n,clearSeekTime:s,contextLogData:o,controls:l,hlsConfig:d,isAutoPlay:u,loop:h,maxHeight:p,maxWidth:m,fiftyPercentHeight:f,objectFit:y,onDurationChange:g,onEnded:S,onFullscreenChange:b,onLoadedChange:v,onControlsPause:P,onControlsPlay:k,onPlayheadDown:E,onPlayheadUp:T,onReady:_,onSeek:w,onTimeChange:A,onVolumeChange:C,playbackRate:R,playing:L,playsInline:I,poster:V,preferMp4:M,preload:F,seekTime:H,src:N,styleOverrides:B,videoStartTime:W,visible:j,volume:U,variant:G}=this.props,$=N?O(N):void 0,K={...d,startPosition:W||-1},z=!S&&h;return this.isHslVideo()&&$?(0,D.jsx)(c.A,{appInFocus:a,aspectRatio:t,backgroundColor:r,captions:i,captionsEnabled:n,clearSeekTime:s,contextLogData:o,controls:l,fiftyPercentHeight:f,hlsConfig:K,isAutoPlay:u,isMainCloseupIdeaVideo:e,loop:h,loopOverride:z,maxHeight:p,maxWidth:m,objectFit:y,onControlsPause:P,onControlsPlay:k,onDurationChange:g,onEnded:this.handleOnEnded,onFullscreenChange:b,onLoadedChange:v,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:E,onPlayheadUp:T,onPlaying:this.handlePlaying,onReady:_,onSeek:w,onTimeChange:A,onVolumeChange:C,playbackRate:R,playing:L,playsInline:I,poster:V,preload:F,seekTime:H,setVideoRef:this.setVideoPlayerRef,src:$,styleOverrides:B,variant:G,visible:j,volume:U}):(0,D.jsx)(x,{aspectRatio:t,backgroundColor:r,captions:i,captionsEnabled:n,clearSeekTime:s,contextLogData:o,controls:l,fiftyPercentHeight:f,isAutoPlay:u,isMainCloseupIdeaVideo:e,loop:h,loopOverride:z,maxHeight:p,maxWidth:m,objectFit:y,onControlsPause:P,onControlsPlay:k,onDurationChange:g,onEnded:this.handleOnEnded,onFullscreenChange:b,onLoadedChange:v,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:E,onPlayheadUp:T,onPlaying:this.handlePlaying,onReady:_,onSeek:w,onTimeChange:A,onVolumeChange:C,playbackRate:R,playing:L,playsInline:I,poster:V,preload:F,seekTime:H,setVideoRef:this.setVideoPlayerRef,src:M?N:$||N,styleOverrides:B,videoStartTime:W,visible:j,volume:U})}}function H(e){(0,n.useEffect)(()=>{(0,i.A)("VideoWrapper","/app/www/video/VideoWrapper.tsx")},[]);let{appUI:{appInFocus:t}}=(0,f.Y)(),{captionsEnabled:a}=(0,m.y)(),{clearSeekTime:r}=(0,u.d1)(),c=(0,d._8)(),{closeupWithinMasonryEnabled:g}=(0,y._G)(),{pinKey:S,seekTime:b,variant:v,objectFit:P,isAutoPlay:k}=e,{styleOverrides:E="",maxHeight:T,maxWidth:_,fiftyPercentHeight:w}=(0,s.kj)({objectFit:P,variant:v}),A=(0,l.A)(V,S),{maxHeight:C}=(0,o.A)({pinKey:A}),{userAgent:{isMobile:R}}=c,L=(0,h.A)("hlsconfig_only"),x=(0,p.A)(L,R),I=k&&void 0===e.preload&&L?x.preloadForAutoplay:e.preload;return(0,D.jsx)(F,{...e,appInFocus:t,clearSeekTime:r,fiftyPercentHeight:w,maxHeight:g?C:T,maxWidth:_,objectFit:P,preload:I,requestContext:c,seekTime:b,styleOverrides:E,toggleCaptions:a,variant:v})}},703593(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=Array(t);a<t;a++)r[a]=e[a];return r},e.exports.__esModule=!0,e.exports.default=e.exports},874355(e,t,a){var r=a(703593);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},572169(e){e.exports=function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},531363(e){function t(e,t,a,r,i,n,s){try{var o=e[n](s),l=o.value}catch(e){return void a(e)}o.done?t(l):Promise.resolve(l).then(r,i)}e.exports=function(e){return function(){var a=this,r=arguments;return new Promise(function(i,n){var s=e.apply(a,r);function o(e){t(s,i,n,o,l,"next",e)}function l(e){t(s,i,n,o,l,"throw",e)}o(void 0)})}},e.exports.__esModule=!0,e.exports.default=e.exports},660989(e,t,a){var r=a(140248);e.exports=function(e,t){var a="u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=r(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==a.return||a.return()}finally{if(l)throw s}}}},e.exports.__esModule=!0,e.exports.default=e.exports},352531(e,t,a){var r=a(136866);e.exports=function(e,t,a){return(t=r(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e},e.exports.__esModule=!0,e.exports.default=e.exports},348888(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)({}).hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},416715(e,t,a){var r=a(896238);e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},528632(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},469253(e){e.exports=function(e){if("u">typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},383079(e){e.exports=function(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},e.exports.__esModule=!0,e.exports.default=e.exports},168067(e,t,a){var r=a(352531);function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,r)}return a}e.exports=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){r(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},768219(e){e.exports=function(e,t){if(null==e)return{};var a={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;a[r]=e[r]}return a},e.exports.__esModule=!0,e.exports.default=e.exports},896238(e){function t(a,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},868114(e,t,a){var r=a(874355),i=a(469253),n=a(140248),s=a(383079);e.exports=function(e){return r(e)||i(e)||n(e)||s()},e.exports.__esModule=!0,e.exports.default=e.exports},265031(e,t,a){var r=a(31948).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},136866(e,t,a){var r=a(31948).default,i=a(265031);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},31948(e){function t(a){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},140248(e,t,a){var r=a(703593);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var a=({}).toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/app-www-video-VideoWrapper.fr-dd4ec38f900e879e.mjs.map